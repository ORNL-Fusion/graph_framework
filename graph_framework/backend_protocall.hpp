//------------------------------------------------------------------------------
///  @file backend_protocall.hpp
///  @brief Class signature to impliment compute backends.
///
///  Defined the function interfaces to access compute resources.
//------------------------------------------------------------------------------

#ifndef backend_protocall_h
#define backend_protocall_h

namespace backend {
//******************************************************************************
//  Data buffer.
//******************************************************************************
//------------------------------------------------------------------------------
///  @brief Class representing a generic buffer.
//------------------------------------------------------------------------------
    template<typename BASE>
    class buffer {
    public:
//------------------------------------------------------------------------------
///  @brief Index operator.
//------------------------------------------------------------------------------
        virtual BASE &operator[] (const size_t index) = 0;

//------------------------------------------------------------------------------
///  @brief Const index operator.
//------------------------------------------------------------------------------
        virtual const BASE &operator[] (const size_t index) const = 0;

//------------------------------------------------------------------------------
///  @brief Get value at.
//------------------------------------------------------------------------------
        virtual const BASE at(const size_t index) const = 0;

//------------------------------------------------------------------------------
///  @brief Assign a constant value.
///
///  @param[in] d Scalar data to set.
//------------------------------------------------------------------------------
        virtual void set(const BASE d) = 0;

//------------------------------------------------------------------------------
///  @brief Get size of the buffer.
//------------------------------------------------------------------------------
        virtual size_t size() const = 0;

//------------------------------------------------------------------------------
///  @brief Get the maximum value from the buffer.
///
///  @returns The maximum value.
//------------------------------------------------------------------------------
        virtual BASE max() const = 0;

//------------------------------------------------------------------------------
///  @brief Is every element the same.
///
///  @returns Returns true if every element is the same.
//------------------------------------------------------------------------------
        virtual bool is_same() const = 0;

//------------------------------------------------------------------------------
///  @brief Is every element zero.
///
///  @returns Returns true if every element is zero.
//------------------------------------------------------------------------------
        virtual bool is_zero() const = 0;

//------------------------------------------------------------------------------
///  @brief Is every element negative.
///
///  @returns Returns true if every element is negative.
//------------------------------------------------------------------------------
        virtual bool is_negative() const = 0;
        
//------------------------------------------------------------------------------
///  @brief Take sqrt.
//------------------------------------------------------------------------------
        virtual void sqrt() = 0;

//------------------------------------------------------------------------------
///  @brief Take exp.
//------------------------------------------------------------------------------
        virtual void exp() = 0;

//------------------------------------------------------------------------------
///  @brief Take log.
//------------------------------------------------------------------------------
        virtual void log() = 0;

//------------------------------------------------------------------------------
///  @brief Take sin.
//------------------------------------------------------------------------------
        virtual void sin() = 0;

//------------------------------------------------------------------------------
///  @brief Take cos.
//------------------------------------------------------------------------------
        virtual void cos() = 0;

//------------------------------------------------------------------------------
///  @brief Get a pointer to the basic memory buffer.
///
///  @returns The pointer to the buffer memory.
//------------------------------------------------------------------------------
        virtual BASE *data() = 0;

///  Type def to retrieve the backend base type.
        typedef BASE base;
    };

//------------------------------------------------------------------------------
///  @brief Cast to a backend base type.
///
///  @param[in] arg Value to case.
///  @returns Cased value.
//------------------------------------------------------------------------------
    template<typename BACKEND, typename T>
    typename BACKEND::base base_cast(const T arg) {
        return static_cast<typename BACKEND::base> (arg);
    }
}

#endif /* backend_protocall_h */
