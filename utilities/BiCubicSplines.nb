(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    208546,       5458]
NotebookOptionsPosition[    195868,       5302]
NotebookOutlinePosition[    196303,       5319]
CellTagsIndexPosition[    196260,       5316]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[" Bicubic Spline Interpolation", "Title",
 CellChangeTimes->{
  3.895843369398959*^9, {3.895849698154237*^9, 
   3.8958497090478086`*^9}},ExpressionUUID->"5eddabab-0458-41c4-86d6-\
a3215d62b023"],

Cell["\<\
This setup cubic splines and scales them for use in the rays code.\
\>", "Text",
 CellChangeTimes->{{3.895849714586388*^9, 
  3.895849735109002*^9}},ExpressionUUID->"2c4c322c-5c01-4143-ad84-\
bfdf36b629e0"],

Cell[CellGroupData[{

Cell["File", "Section",
 CellChangeTimes->{{3.892041893029974*^9, 
  3.8920418933354692`*^9}},ExpressionUUID->"c5ba8346-8b2a-4360-b5bb-\
ffb2c5d84a49"],

Cell[BoxData[
 RowBox[{"file", "=", 
  RowBox[{"SystemDialogInput", "[", "\"\<FileOpen\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.892041895597033*^9, 3.892041909823761*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"a3271e63-15a0-44e8-8f73-02046ec37aae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"b0", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Import", "[", 
     RowBox[{"file", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Datasets\>\"", ",", "\"\<b0\>\""}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r0", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Import", "[", 
     RowBox[{"file", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Datasets\>\"", ",", "\"\<rcentr\>\""}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psi", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Import", "[", 
     RowBox[{"file", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Datasets\>\"", ",", "\"\<psi\>\""}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rdim", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"file", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\<rdim\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zdim", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"file", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\<zdim\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rleft", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"file", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\<rleft\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zmid", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"file", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\<zmid\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psibry", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"file", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\<psibry\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fpol", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Import", "[", 
     RowBox[{"file", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Datasets\>\"", ",", "\"\<fpol\>\""}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pres", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Import", "[", 
     RowBox[{"file", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Datasets\>\"", ",", "\"\<pres\>\""}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Import", "[", 
     RowBox[{"file", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Datasets\>\"", ",", "\"\<rho\>\""}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ne", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Import", "[", 
     RowBox[{"file", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Datasets\>\"", ",", "\"\<ne\>\""}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"te", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Import", "[", 
     RowBox[{"file", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Datasets\>\"", ",", "\"\<te\>\""}], "}"}]}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8920419340686703`*^9, 3.892041936490707*^9}, {
   3.892041974268519*^9, 3.8920420358801727`*^9}, {3.892042658755859*^9, 
   3.892042662700996*^9}, {3.892047462719078*^9, 3.892047491995831*^9}, {
   3.892049547965063*^9, 3.892049563205728*^9}, {3.892157229369276*^9, 
   3.892157256011817*^9}, {3.8921586733483343`*^9, 3.89215870710527*^9}, {
   3.902312384491248*^9, 3.902312386203743*^9}, {3.932566982769849*^9, 
   3.932567004976758*^9}, 3.932568290475823*^9, {3.932569713383298*^9, 
   3.932569713841702*^9}, {3.954951146189992*^9, 3.954951198976245*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"de31985c-11ba-4789-9b9d-aaebe9694569"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"width", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"file", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\<width\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"height", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"file", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\<height\>\""}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.892042078480571*^9, 3.8920420921480093`*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"1bf110d9-e785-4c6a-b732-832eca4086f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rmax", "=", 
   RowBox[{"rleft", "+", "rdim"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zmin", "=", 
   RowBox[{"zmid", "-", 
    RowBox[{"zdim", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zmax", "=", 
   RowBox[{"zmid", "+", 
    RowBox[{"zdim", "/", "2"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.892042044177891*^9, 3.892042121982608*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"3a57c42a-9008-4fe3-8a01-8c9844291290"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "psi", "]"}]], "Input",
 CellChangeTimes->{{3.892042177464219*^9, 3.892042184388467*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"d2f3f0f3-136e-4aec-a3f7-c612e8bfdc1b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cubic Spline", "Section",
 CellChangeTimes->{{3.8920233360074873`*^9, 
  3.892023339201929*^9}},ExpressionUUID->"07f0000e-fbc0-4705-ba75-\
d481a5fc7e9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"m", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "==", "j"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "==", "1"}], "||", 
          RowBox[{"i", "==", "n"}]}], ",", "2", ",", "4"}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "==", 
           RowBox[{"j", "-", "1"}]}], "||", 
          RowBox[{"i", "==", 
           RowBox[{"j", "+", "1"}]}]}], ",", "1", ",", "0"}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.8920233882682962`*^9},
 CellLabel->"In[91]:=",ExpressionUUID->"0498a238-2230-4072-9a52-ed7347f711ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", "a_", "]"}], "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"3", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"[", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"i", "+", "1"}], ",", "n"}], "]"}], "]"}], "]"}], "-", 
        RowBox[{"a", "[", 
         RowBox[{"[", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}], "]"}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.892023390101123*^9},
 CellLabel->"In[92]:=",ExpressionUUID->"59a40430-05e5-4502-ae3a-96e42b9ab617"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "a_", "]"}], ":=", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{
     RowBox[{"m", "[", 
      RowBox[{"Length", "[", "a", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"b", "[", "a", "]"}], "[", 
      RowBox[{"Length", "[", "a", "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[93]:=",ExpressionUUID->"fd9b5d1a-7d75-41a4-b20a-947f2ddd44c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"c1D", "[", "a_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ds", ",", "c0", ",", "c1", ",", "c2", ",", "c3", ",", "i"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ds", "=", 
      RowBox[{"d", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c0", "=", 
      RowBox[{"a", "[", 
       RowBox[{"[", 
        RowBox[{";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c1", "=", 
      RowBox[{"ds", "[", 
       RowBox[{"[", 
        RowBox[{";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c2", "=", 
      RowBox[{
       RowBox[{"3", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}], "-", 
          RowBox[{"a", "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}]}], ")"}]}], "-", 
       RowBox[{"2", "*", 
        RowBox[{"ds", "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}], "-", 
       RowBox[{"ds", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c3", "=", 
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}], "-", 
          RowBox[{"a", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}]}], "+", 
       RowBox[{"ds", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}], "+", 
       RowBox[{"ds", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"i", "-", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "c0", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c0", "-", 
        RowBox[{"c1", "*", "i"}], "+", 
        RowBox[{"c2", "*", "i", "*", "i"}], "-", 
        RowBox[{"c3", "*", "i", "*", "i", "*", "i"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"c1", "-", 
        RowBox[{"2", "*", "c2", "*", "i"}], "+", 
        RowBox[{"3", "*", "c3", "*", "i", "*", "i"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"c2", "-", 
        RowBox[{"3", "c3", "*", "i"}]}], ",", "\[IndentingNewLine]", "c3"}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8921580340560017`*^9, 3.892158102725237*^9}, {
   3.892158152397287*^9, 3.8921585028221483`*^9}, {3.892160824287022*^9, 
   3.8921608245758457`*^9}, {3.892370705761764*^9, 3.8923707083446913`*^9}, {
   3.892370906066586*^9, 3.892370952360717*^9}, {3.892370985143395*^9, 
   3.892371079455968*^9}, {3.892371450822637*^9, 3.892371463154079*^9}, {
   3.8923717415075397`*^9, 3.89237174392227*^9}, {3.8923717796468163`*^9, 
   3.8923717883707933`*^9}, {3.892371844548152*^9, 3.892371857100123*^9}, {
   3.892372023517686*^9, 3.892372040246737*^9}, {3.892372072104394*^9, 
   3.892372080500855*^9}, {3.892372114233197*^9, 3.892372130742669*^9}, 
   3.892372189034726*^9, {3.892372246887389*^9, 3.892372247244236*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"126e3279-7860-4eb4-9416-3620a44b9b1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "dx_", "]"}], "[", "a_", "]"}], "[", "xmin_", "]"}], 
    "[", "x_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ilow", ",", "xnorm", ",", "result", ",", "c0", ",", "c1", ",", "c2", 
       ",", "c3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ilow", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "-", "xmin"}], ")"}], "/", "dx"}], "]"}], "+", 
            "1"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", "a", "]"}], "-", "1"}]}], "]"}], ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xnorm", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "xmin"}], ")"}], "/", "dx"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c0", ",", "c1", ",", "c2", ",", "c3"}], "}"}], "=", 
       RowBox[{"c1D", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{
        RowBox[{"c0", "[", 
         RowBox[{"[", "ilow", "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"c1", "[", 
          RowBox[{"[", "ilow", "]"}], "]"}], "*", "xnorm"}], "+", 
        RowBox[{
         RowBox[{"c2", "[", 
          RowBox[{"[", "ilow", "]"}], "]"}], "*", "xnorm", "*", "xnorm"}], 
        "+", 
        RowBox[{
         RowBox[{"c3", "[", 
          RowBox[{"[", "ilow", "]"}], "]"}], "*", "xnorm", "*", "xnorm", "*", 
         "xnorm"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "ilow", ",", "xnorm", ",", "result"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.89202349779387*^9, 3.892023501373464*^9}, {
   3.892028188913743*^9, 3.892028195549863*^9}, {3.892029103726268*^9, 
   3.892029130508198*^9}, {3.892029281360929*^9, 3.892029281517174*^9}, 
   3.892030402441033*^9, {3.8920423545682497`*^9, 3.892042363577043*^9}, {
   3.892042402694336*^9, 3.8920424160555143`*^9}, 3.892042551292967*^9, {
   3.8923700229395323`*^9, 3.892370107161224*^9}, {3.8923714360986547`*^9, 
   3.892371438023884*^9}, {3.89237147108285*^9, 3.892371475353508*^9}, {
   3.892371750119183*^9, 3.892371797720069*^9}, {3.8923719360052853`*^9, 
   3.8923719650541153`*^9}, {3.892372218768365*^9, 3.892372220283751*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"29369115-0f38-4bdc-9833-becb55d928e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"df", "[", "dx_", "]"}], "[", "a_", "]"}], "[", "xmin_", "]"}], 
    "[", "x_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ilow", ",", "xnorm", ",", "result", ",", "c0", ",", "c1", ",", "c2", 
       ",", "c3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ilow", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "-", "xmin"}], ")"}], "/", "dx"}], "]"}], "+", 
            "1"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", "a", "]"}], "-", "1"}]}], "]"}], ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xnorm", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "xmin"}], ")"}], "/", "dx"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c0", ",", "c1", ",", "c2", ",", "c3"}], "}"}], "=", 
       RowBox[{"c1D", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c1", "[", 
          RowBox[{"[", "ilow", "]"}], "]"}], "+", 
         RowBox[{"2", "*", 
          RowBox[{"c2", "[", 
           RowBox[{"[", "ilow", "]"}], "]"}], "*", "xnorm"}], "+", 
         RowBox[{"3", "*", 
          RowBox[{"c3", "[", 
           RowBox[{"[", "ilow", "]"}], "]"}], "*", "xnorm", "*", "xnorm"}]}], 
        ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "ilow", ",", "xnorm", ",", "result"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8920234510024014`*^9, 3.892023505182362*^9}, {
   3.892028993818131*^9, 3.8920290039523287`*^9}, {3.892029100996666*^9, 
   3.892029101167601*^9}, {3.892029137274479*^9, 3.892029139315462*^9}, {
   3.8920292833251266`*^9, 3.892029283454857*^9}, {3.892030383633857*^9, 
   3.892030396440256*^9}, 3.892042367810234*^9, {3.89204241850943*^9, 
   3.8920424223390083`*^9}, 3.892042552754092*^9, {3.892370117350216*^9, 
   3.8923701457709217`*^9}, {3.892370180622995*^9, 3.892370180748425*^9}, {
   3.8939270972431107`*^9, 3.893927114606641*^9}, 3.893927277789456*^9, {
   3.893927713120075*^9, 3.893927729465468*^9}, {3.893928113409233*^9, 
   3.893928118534067*^9}, 3.893929029078435*^9, {3.893930427780477*^9, 
   3.893930428527048*^9}, {3.893930764467462*^9, 3.893930764878241*^9}, {
   3.9104431427957697`*^9, 3.910443143483019*^9}, {3.932137731521925*^9, 
   3.9321377323408413`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"fe8cd419-2e52-4aa5-b4cd-40cf52143072"]
}, Open  ]],

Cell[CellGroupData[{

Cell["BiCubic", "Section",
 CellChangeTimes->{{3.892023558831846*^9, 
  3.892023560636237*^9}},ExpressionUUID->"a55628ec-9aad-4115-b5ce-\
b0860c7bd02e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xGrid", "=", 
   RowBox[{"Subdivide", "[", 
    RowBox[{"rleft", ",", "rmax", ",", 
     RowBox[{"width", "-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yGrid", "=", 
   RowBox[{"Subdivide", "[", 
    RowBox[{"zmin", ",", "zmax", ",", 
     RowBox[{"height", "-", "1"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.892023595992824*^9, 3.89202363742968*^9}, {
  3.892024795571186*^9, 3.892024800595652*^9}, {3.89202734782493*^9, 
  3.892027349369072*^9}, {3.892027700513753*^9, 3.892027701862645*^9}, {
  3.892027923340143*^9, 3.892027925669426*^9}, {3.892031133526352*^9, 
  3.892031134466406*^9}, {3.8920316794401073`*^9, 3.892031688968432*^9}, {
  3.892037379770993*^9, 3.892037382207017*^9}, {3.892042134669364*^9, 
  3.892042160082445*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"544e5f48-c95e-4e0d-9368-29cc3c61c75c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dx", "=", 
   RowBox[{
    RowBox[{"xGrid", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "-", 
    RowBox[{"xGrid", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dy", "=", 
   RowBox[{
    RowBox[{"yGrid", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "-", 
    RowBox[{"yGrid", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.892029245245359*^9, 3.8920292641991377`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"1a732b3d-6ac1-4c76-9406-a21d89b62dd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zGrid", "=", "psi"}], ";"}]], "Input",
 CellChangeTimes->{{3.892023630335046*^9, 3.892023735159083*^9}, {
  3.892023780596615*^9, 3.89202379368784*^9}, {3.892024090597261*^9, 
  3.892024097032707*^9}, {3.892042196082705*^9, 3.892042196884942*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"f72fdd49-95f3-431b-988c-d7d8e4439193"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"c1D", "[", 
   RowBox[{"zGrid", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", ";;"}], "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.892371546690359*^9, 3.8923715610811243`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"99d95e68-2702-4f42-835f-72613f2e7903"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"f", "[", "dx", "]"}], "[", 
             RowBox[{"zGrid", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", ";;"}], "]"}], "]"}], "]"}], "[", "rleft", 
            "]"}], "[", "x", "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListInterpolation", "[", 
           RowBox[{
            RowBox[{"zGrid", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", ";;"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Min", "[", "xGrid", "]"}], ",", 
              RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}]}], "]"}], "[", "x", 
          "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"Min", "[", "xGrid", "]"}], ",", 
         RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
       RowBox[{"PlotPoints", "->", "100"}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{"Red", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"xGrid", ",", 
         RowBox[{"zGrid", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", ";;"}], "]"}], "]"}]}], "}"}], "]"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", 
     RowBox[{"Length", "[", "yGrid", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8920294945653477`*^9, 3.8920296818820677`*^9}, {
   3.892042374620142*^9, 3.892042384217544*^9}, {3.89204250603461*^9, 
   3.8920425061844053`*^9}, {3.892042635141612*^9, 3.8920426366352367`*^9}, {
   3.892046199931983*^9, 3.8920462082381973`*^9}, 3.8923701909018297`*^9, {
   3.8923711908117447`*^9, 3.892371294183992*^9}, {3.892371325340788*^9, 
   3.892371362337644*^9}, 3.892371408982079*^9, {3.89237172592064*^9, 
   3.8923717285056143`*^9}, {3.893925125434965*^9, 3.893925175396921*^9}, {
   3.893927450888712*^9, 3.89392745971782*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"4e948bf4-a954-4490-84f4-56f702ff1941"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "zGrid", "]"}]], "Input",
 CellChangeTimes->{{3.892023810210177*^9, 3.892023814698695*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"fe1e6fb9-8961-4106-aa4c-f9fb4e5f6023"],

Cell[BoxData[
 RowBox[{"ListContourPlot", "[", 
  RowBox[{
   RowBox[{"zGrid", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", ";;"}], "]"}], "]"}], ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "xGrid", "]"}], ",", 
        RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "yGrid", "]"}], ",", 
        RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
   RowBox[{"ContourShading", "->", "None"}], ",", " ", 
   RowBox[{"Contours", "->", "100"}], ",", 
   RowBox[{"AspectRatio", "->", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892023741008898*^9, 3.8920237689975233`*^9}, {
  3.892027882916883*^9, 3.892027956642962*^9}, {3.892037156089628*^9, 
  3.892037210557448*^9}, {3.892037268421125*^9, 3.8920372714065847`*^9}, {
  3.892042697085063*^9, 3.892042758119959*^9}, {3.8920428850525084`*^9, 
  3.8920429117877903`*^9}, {3.89204316203855*^9, 3.8920431748946743`*^9}, {
  3.8920461476225452`*^9, 3.892046174890299*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"964788eb-ca07-4efa-8f17-bcf5325838bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dzdxgrid", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"df", "[", "dx", "]"}], "[", 
         RowBox[{"zGrid", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", ";;"}], "]"}], "]"}], "]"}], "[", "rleft", "]"}],
        "[", 
       RowBox[{"xGrid", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", "yGrid", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "xGrid", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.892023824263739*^9, 3.892023867894858*^9}, {
   3.892023914108932*^9, 3.892023931604065*^9}, {3.892023981607287*^9, 
   3.892024006736904*^9}, {3.8920240633276854`*^9, 3.8920240663033743`*^9}, {
   3.892024104812389*^9, 3.892024109519266*^9}, {3.8920245179331207`*^9, 
   3.892024528266094*^9}, {3.89202462863855*^9, 3.8920246373036413`*^9}, {
   3.8920292714725447`*^9, 3.892029273691306*^9}, {3.892030850661296*^9, 
   3.892030877719936*^9}, {3.892030990630486*^9, 3.892030993669095*^9}, {
   3.892042928342265*^9, 3.892042938326207*^9}, {3.892043068019246*^9, 
   3.892043068770486*^9}, {3.892046183419056*^9, 3.89204618654504*^9}, {
   3.8920462321812162`*^9, 3.892046233958848*^9}, {3.892046265703452*^9, 
   3.8920462676082287`*^9}, {3.8920463104796257`*^9, 3.8920463140367937`*^9}, 
   3.8923722800630817`*^9, {3.893925502957823*^9, 3.893925507396152*^9}, 
   3.8939290624824667`*^9},
 CellLabel->
  "In[106]:=",ExpressionUUID->"b6fb8293-e767-47bc-a208-83ba3c6f43fe"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"df", "[", "dx", "]"}], "[", 
              RowBox[{"zGrid", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", ";;"}], "]"}], "]"}], "]"}], "[", "rleft", 
             "]"}], "[", "x", "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], "/", "dx"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ListInterpolation", "[", 
            RowBox[{
             RowBox[{"zGrid", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", ";;"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Min", "[", "xGrid", "]"}], ",", 
               RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}]}], "]"}], "'"}], 
          "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"Min", "[", "xGrid", "]"}], ",", 
         RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "->", "Full"}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{"Red", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"xGrid", ",", 
            RowBox[{
             RowBox[{"dzdxgrid", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", ";;"}], "]"}], "]"}], "/", "dx"}]}], "}"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"xGrid", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;"}], "]"}], "]"}], "+", 
               RowBox[{"xGrid", "[", 
                RowBox[{"[", 
                 RowBox[{";;", 
                  RowBox[{"-", "2"}]}], "]"}], "]"}]}], ")"}], "/", "2"}], 
            ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"zGrid", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", 
                  RowBox[{"2", ";;"}]}], "]"}], "]"}], "-", 
               RowBox[{"zGrid", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", 
                  RowBox[{";;", 
                   RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"xGrid", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;"}], "]"}], "]"}], "-", 
               RowBox[{"xGrid", "[", 
                RowBox[{"[", 
                 RowBox[{";;", 
                  RowBox[{"-", "2"}]}], "]"}], "]"}]}], ")"}]}]}], "}"}], 
          "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{"Red", ",", "Blue"}], "}"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", 
     RowBox[{"Length", "[", "yGrid", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.892042998245734*^9, 3.8920430814708776`*^9, {3.892046244119924*^9, 
   3.8920462539113083`*^9}, 3.892372289847755*^9, {3.893925080301478*^9, 
   3.8939251118737307`*^9}, {3.893925212357786*^9, 3.893925251381312*^9}, {
   3.893925493271364*^9, 3.893925530005539*^9}, {3.8939255774427*^9, 
   3.893925583513771*^9}, {3.8939257159530907`*^9, 3.893925718555814*^9}, {
   3.8939257514692*^9, 3.893925763164033*^9}, {3.893926631467039*^9, 
   3.89392663418221*^9}, {3.893926743536697*^9, 3.893926881690071*^9}, {
   3.8939269853348217`*^9, 3.893927030807735*^9}, 3.893927406045828*^9, {
   3.893927534614066*^9, 3.89392755362621*^9}, {3.893927799491501*^9, 
   3.893927965536723*^9}, {3.893929072469441*^9, 3.893929110323077*^9}, {
   3.8939304448870993`*^9, 3.893930449091476*^9}, {3.893930787048313*^9, 
   3.89393079461134*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"de101dd5-20e7-4452-b98a-b5ca9c473502"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "dzdxgrid", "]"}]], "Input",
 CellChangeTimes->{{3.892023960644972*^9, 3.8920239680350237`*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"2edc4726-58c3-42b6-9408-bf1938741c2b"],

Cell[BoxData[
 RowBox[{"ListContourPlot", "[", 
  RowBox[{"dzdxgrid", ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "xGrid", "]"}], ",", 
        RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "yGrid", "]"}], ",", 
        RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
   RowBox[{"ContourShading", "->", "None"}], ",", " ", 
   RowBox[{"Contours", "->", "100"}], ",", 
   RowBox[{"AspectRatio", "->", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.892023938512713*^9, {3.8920279647456217`*^9, 3.8920279656648493`*^9}, 
   3.892037291892013*^9, {3.8920431124380703`*^9, 3.892043146637295*^9}, 
   3.8920431834887733`*^9, {3.892046348348269*^9, 3.892046352296927*^9}, {
   3.8920465340367126`*^9, 3.892046534277728*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"75f340da-b8d4-4be0-a80b-780f5b98f0dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dzdygrid", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"df", "[", "dy", "]"}], "[", 
         RowBox[{"zGrid", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "i"}], "]"}], "]"}], "]"}], "[", "zmin", "]"}], 
       "[", 
       RowBox[{"yGrid", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", "yGrid", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "xGrid", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.892024827750936*^9, 3.8920248574829807`*^9}, {
   3.892029314250433*^9, 3.8920293160633173`*^9}, {3.89203102796553*^9, 
   3.8920310356331043`*^9}, {3.89204452358784*^9, 3.8920445327479067`*^9}, {
   3.89204641198691*^9, 3.892046413753088*^9}, {3.892046451340163*^9, 
   3.892046453494431*^9}, 3.8923723102218*^9, {3.893928268713999*^9, 
   3.893928278465769*^9}, 3.893929142224328*^9},
 CellLabel->
  "In[110]:=",ExpressionUUID->"36737fa4-08f7-4315-9138-559288bac633"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"df", "[", "dy", "]"}], "[", 
              RowBox[{"zGrid", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "i"}], "]"}], "]"}], "]"}], "[", "zmin", 
             "]"}], "[", "y", "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], "/", "dy"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ListInterpolation", "[", 
            RowBox[{
             RowBox[{"zGrid", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "i"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Min", "[", "yGrid", "]"}], ",", 
               RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}]}], "]"}], "'"}], 
          "[", "y", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"Min", "[", "yGrid", "]"}], ",", 
         RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "->", "Full"}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{"Red", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"yGrid", ",", 
            RowBox[{
             RowBox[{"dzdygrid", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "i"}], "]"}], "]"}], "/", "dy"}]}], "}"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"yGrid", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;"}], "]"}], "]"}], "+", 
               RowBox[{"yGrid", "[", 
                RowBox[{"[", 
                 RowBox[{";;", 
                  RowBox[{"-", "2"}]}], "]"}], "]"}]}], ")"}], "/", "2"}], 
            ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"zGrid", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"2", ";;"}], ",", "i"}], "]"}], "]"}], "-", 
               RowBox[{"zGrid", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{";;", 
                   RowBox[{"-", "2"}]}], ",", "i"}], "]"}], "]"}]}], ")"}], 
             "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"yGrid", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;"}], "]"}], "]"}], "-", 
               RowBox[{"yGrid", "[", 
                RowBox[{"[", 
                 RowBox[{";;", 
                  RowBox[{"-", "2"}]}], "]"}], "]"}]}], ")"}]}]}], "}"}], 
          "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{"Red", ",", "Blue"}], "}"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "xGrid", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8920451469867887`*^9, 3.892045176515232*^9}, {
   3.8920453419267*^9, 3.892045391206807*^9}, {3.892046421909883*^9, 
   3.892046427764132*^9}, 3.892372316503098*^9, {3.893928160918251*^9, 
   3.893928161214113*^9}, {3.893928193830001*^9, 3.893928257935175*^9}, {
   3.893928292475924*^9, 3.893928347480832*^9}, 3.893928391105034*^9, {
   3.893928439357417*^9, 3.893928445752668*^9}, {3.893928500693645*^9, 
   3.893928503604434*^9}, {3.893929163471643*^9, 3.893929194873431*^9}, {
   3.8939304574002533`*^9, 3.893930460171797*^9}, {3.893930807470323*^9, 
   3.893930815733046*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"50c39e01-1a79-477d-b071-dbad65cf1765"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "dzdygrid", "]"}]], "Input",
 CellChangeTimes->{3.892024900965692*^9},
 CellLabel->
  "In[112]:=",ExpressionUUID->"89b820f0-c4dd-4691-a98e-25693005a373"],

Cell[BoxData[
 RowBox[{"ListContourPlot", "[", 
  RowBox[{"dzdygrid", ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "xGrid", "]"}], ",", 
        RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "yGrid", "]"}], ",", 
        RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
   RowBox[{"ContourShading", "->", "None"}], ",", " ", 
   RowBox[{"Contours", "->", "100"}], ",", 
   RowBox[{"AspectRatio", "->", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.892024922529106*^9, 3.89202799022458*^9, 3.892037299957973*^9, {
   3.892044543573636*^9, 3.89204455614318*^9}, {3.892046525489328*^9, 
   3.892046528212987*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"12a2aaac-42e4-4214-9624-b719748c9961"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dzdxygrid", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"df", "[", "dx", "]"}], "[", 
         RowBox[{"dzdygrid", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", ";;"}], "]"}], "]"}], "]"}], "[", "rleft", "]"}],
        "[", 
       RowBox[{"xGrid", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", "yGrid", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "xGrid", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.892024936388101*^9, 3.892024943957839*^9}, {
   3.892029349627239*^9, 3.892029350893175*^9}, {3.8920310516881247`*^9, 
   3.892031067841308*^9}, {3.892044569157187*^9, 3.892044577165069*^9}, {
   3.892046477387916*^9, 3.89204648584916*^9}, 3.892372330564117*^9},
 CellLabel->
  "In[114]:=",ExpressionUUID->"3f4450b7-d1f0-4f7b-8e23-6b8d99b4d474"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"df", "[", "dx", "]"}], "[", 
           RowBox[{"dzdygrid", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", ";;"}], "]"}], "]"}], "]"}], "[", "rleft", 
          "]"}], "[", "x", "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"Min", "[", "xGrid", "]"}], ",", 
         RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"xGrid", ",", 
         RowBox[{"dzdxygrid", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", ";;"}], "]"}], "]"}]}], "}"}], "]"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", 
     RowBox[{"Length", "[", "yGrid", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.892045429731862*^9, 3.8920454397039127`*^9}, {
   3.89204648997797*^9, 3.892046497024109*^9}, 3.892372338312107*^9},
 CellLabel->
  "In[115]:=",ExpressionUUID->"66eb1b9d-1a7e-4a03-b2b0-59e0f57471f8"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "dzdxygrid", "]"}]], "Input",
 CellChangeTimes->{3.892024954456613*^9},
 CellLabel->
  "In[116]:=",ExpressionUUID->"d687f703-feac-4cc8-ac28-891f22fac149"],

Cell[BoxData[
 RowBox[{"ListContourPlot", "[", 
  RowBox[{"dzdxygrid", ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "xGrid", "]"}], ",", 
        RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "yGrid", "]"}], ",", 
        RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
   RowBox[{"ContourShading", "->", "None"}], ",", " ", 
   RowBox[{"Contours", "->", "100"}], ",", 
   RowBox[{"AspectRatio", "->", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.892024960377593*^9, 3.892027999639256*^9, 3.892037310945511*^9, {
   3.892044585072747*^9, 3.8920445906778593`*^9}, {3.892046552138295*^9, 
   3.8920465523975487`*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"c86dae18-d674-42c5-82a6-6774de23aae8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dzdxygrid2", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"df", "[", "dy", "]"}], "[", 
         RowBox[{"dzdxgrid", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "i"}], "]"}], "]"}], "]"}], "[", "zmin", "]"}], 
       "[", 
       RowBox[{"yGrid", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", "yGrid", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "xGrid", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.892024971165936*^9, 3.892025008536524*^9}, {
   3.892029358084597*^9, 3.892029360098879*^9}, {3.89203107910382*^9, 
   3.892031086041388*^9}, {3.892044606515604*^9, 3.892044609178276*^9}, {
   3.892046559730838*^9, 3.8920465666045847`*^9}, 3.892372356936314*^9},
 CellLabel->
  "In[118]:=",ExpressionUUID->"f189a062-44b1-4078-a65e-e6304657ae0e"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"df", "[", "dy", "]"}], "[", 
           RowBox[{"dzdxgrid", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "i"}], "]"}], "]"}], "]"}], "[", "zmin", 
          "]"}], "[", "y", "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"Min", "[", "yGrid", "]"}], ",", 
         RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"yGrid", ",", 
         RowBox[{"dzdxygrid2", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "i"}], "]"}], "]"}]}], "}"}], "]"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "xGrid", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.892045467559259*^9, 3.892045470339066*^9}, {
   3.892046571528981*^9, 3.892046577314062*^9}, 3.8923723548387213`*^9},
 CellLabel->
  "In[119]:=",ExpressionUUID->"8288630e-698e-46e1-84ab-b204bc98b39c"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "dzdxygrid2", "]"}]], "Input",
 CellChangeTimes->{3.892025015684642*^9, 3.892029370828013*^9},
 CellLabel->
  "In[120]:=",ExpressionUUID->"1182f37e-1b9c-42e6-8341-ebae544be9c0"],

Cell[BoxData[
 RowBox[{"ListContourPlot", "[", 
  RowBox[{"dzdxygrid2", ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "xGrid", "]"}], ",", 
        RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "yGrid", "]"}], ",", 
        RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
   RowBox[{"ContourShading", "->", "None"}], ",", " ", 
   RowBox[{"Contours", "->", "100"}], ",", 
   RowBox[{"AspectRatio", "->", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.892025020661055*^9, 3.8920293769772167`*^9, 3.892037318708506*^9, 
   3.892037356382167*^9, {3.892044615725288*^9, 3.892044623231175*^9}, {
   3.8920465870759277`*^9, 3.892046587310933*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"b77839a1-27ce-417b-95a5-2f6c9061760a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fmatrix", "[", 
    RowBox[{"f_", ",", "dx_", ",", "dy_", ",", "dxdy_"}], "]"}], "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"j", "+", "1"}], ",", "i"}], "]"}], "]"}], ",", 
      RowBox[{"dy", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
      RowBox[{"dy", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"j", "+", "1"}], ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", 
         RowBox[{"i", "+", "1"}]}], "]"}], "]"}], ",", 
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"j", "+", "1"}], ",", 
         RowBox[{"i", "+", "1"}]}], "]"}], "]"}], ",", 
      RowBox[{"dy", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", 
         RowBox[{"i", "+", "1"}]}], "]"}], "]"}], ",", 
      RowBox[{"dy", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"j", "+", "1"}], ",", 
         RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dx", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
      RowBox[{"dx", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"j", "+", "1"}], ",", "i"}], "]"}], "]"}], ",", 
      RowBox[{"dxdy", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
      RowBox[{"dxdy", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"j", "+", "1"}], ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dx", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", 
         RowBox[{"i", "+", "1"}]}], "]"}], "]"}], ",", 
      RowBox[{"dx", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"j", "+", "1"}], ",", 
         RowBox[{"i", "+", "1"}]}], "]"}], "]"}], ",", 
      RowBox[{"dxdy", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", 
         RowBox[{"i", "+", "1"}]}], "]"}], "]"}], ",", 
      RowBox[{"dxdy", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"j", "+", "1"}], ",", 
         RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.892025527490198*^9, 3.892025549477934*^9}, {
  3.892025585949869*^9, 3.8920256337723703`*^9}, {3.8920257349891977`*^9, 
  3.89202586907662*^9}, {3.892027243104834*^9, 3.892027324582049*^9}, {
  3.892027418466292*^9, 3.89202744362782*^9}, {3.8920275992214727`*^9, 
  3.892027655755488*^9}, {3.89203180789958*^9, 3.892031837250643*^9}, {
  3.892031870699916*^9, 3.892031927103528*^9}, {3.8920350951794*^9, 
  3.8920351235217743`*^9}, {3.892035179245469*^9, 3.892035195486562*^9}, {
  3.892035238956379*^9, 3.892035258492642*^9}, {3.8920353251737137`*^9, 
  3.892035350057931*^9}, {3.892035405752017*^9, 3.89203542351733*^9}, {
  3.8920466531382027`*^9, 3.892046743370677*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"ca2ea03b-a84f-4c06-a12b-cdafe9092b55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"left", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3"}], ",", "3", ",", 
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "2"}], ",", "1", ",", "1"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8920258984872723`*^9, 3.892025943781248*^9}, 
   3.892035475384165*^9, {3.8920456745112247`*^9, 3.892045678899536*^9}, {
   3.892045734597685*^9, 3.892045736959268*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"8099d70c-0231-4401-b184-21309806bec8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"right", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", 
       RowBox[{"-", "3"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "3", ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", 
       RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892025950132815*^9, 3.892025982318634*^9}, {
  3.892035477199025*^9, 3.8920354777524977`*^9}, {3.8920456825525846`*^9, 
  3.892045684206786*^9}, {3.892045729579668*^9, 3.89204573207856*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"b28c0edf-59dc-4ee4-8393-f8955fde1691"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"left", ".", 
    RowBox[{
     RowBox[{"fmatrix", "[", 
      RowBox[{"zGrid", ",", "dzdxgrid", ",", "dzdygrid", ",", "dzdxygrid"}], 
      "]"}], "[", 
     RowBox[{"i", ",", "j"}], "]"}], ".", "right"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892025989046077*^9, 3.892026052357139*^9}, {
  3.892035487537599*^9, 3.892035490201345*^9}, {3.8920456595783443`*^9, 
  3.892045669845417*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"ccb9d60c-8eb1-4e58-acf5-3fdd7312ddc8"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"Table", "[", 
   RowBox[{"1", ",", "10", ",", "5"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.892383191493979*^9, 3.8923832352873707`*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"7d804952-202a-4ef2-8e1e-66c8670c8646"],

Cell[BoxData[
 RowBox[{
  RowBox[{"coefficents", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{
        RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{
        RowBox[{"Length", "[", "yGrid", "]"}], "-", "1"}]}], "}"}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.8920260633831577`*^9, 3.892026099510935*^9}, {
   3.892026129623027*^9, 3.892026154055562*^9}, {3.89202645231415*^9, 
   3.8920264595090714`*^9}, 3.892035040459998*^9, {3.8920355299508257`*^9, 
   3.8920355309732037`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"f86be90d-d06a-4d5d-a15b-e12c0137171e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"igrid", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"i", "-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"zGrid", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jgrid", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"j", "-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{
        RowBox[{"Length", "[", "zGrid", "]"}], "-", "1"}]}], "}"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.892159451521222*^9, 3.892159534822872*^9}, {
  3.89237447005674*^9, 3.892374472625476*^9}, {3.8923822384065943`*^9, 
  3.892382267284872*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"78fcc981-37c2-402f-adbf-182b55edf9cb"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "coefficents", "]"}]], "Input",
 CellChangeTimes->{{3.892036957304904*^9, 3.8920369610378323`*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"b8455c83-7ca2-42f3-9bca-80bbaa00d3a7"],

Cell[BoxData[
 RowBox[{"cSym", "=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c00", ",", "c01", ",", "c02", ",", "c03"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"c10", ",", "c11", ",", "c12", ",", "c13"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"c20", ",", "c21", ",", "c22", ",", "c23"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"c30", ",", "c31", ",", "c32", ",", "c33"}], "}"}]}], 
   "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.892379724821713*^9, 3.8923797276459093`*^9}, {
  3.892380020040964*^9, 3.892380021989718*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"4db62d0b-2b7c-4c1b-b3f0-516283da13f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"csym2d", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "1"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "1"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "jp"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "2"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "2"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "1"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "jp"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"j", "-", "1"}], ")"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "1"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "2"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "jp"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "2"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], "]"}], 
        "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "3"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "3"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "1"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "jp"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], "]"}], 
        "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "1"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "3"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "jp"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "3"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"i", "-", "3"}], ",", "0"}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "4"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "4"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "1"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "jp"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"j", "-", "3"}], ",", "0"}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "1"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "4"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "jp"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "4"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"j", "-", "1"}], ")"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "2"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "2"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "2"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "jp"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "2"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], "]"}], 
        "*", 
        RowBox[{"(", 
         RowBox[{"j", "-", "1"}], ")"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "3"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "3"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "2"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "jp"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "2"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "*", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], "]"}], 
        "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "2"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "2"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "3"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "jp"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "3"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"i", "-", "3"}], ",", "0"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"j", "-", "1"}], ")"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "4"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "4"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "2"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "jp"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "2"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "*", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"j", "-", "3"}], ",", "0"}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "2"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "2"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "4"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "v"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "4"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], "]"}], 
        "*", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], "]"}], 
        "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "3"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "3"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "3"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "jp"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "3"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"i", "-", "3"}], ",", "0"}], "]"}], "*", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], "]"}], 
        "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "4"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "4"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "3"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "jp"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "3"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], "]"}], 
        "*", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"j", "-", "3"}], ",", "0"}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "3"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "3"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "4"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "jp"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "4"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"i", "-", "3"}], ",", "0"}], "]"}], "*", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"j", "-", "3"}], ",", "0"}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "-", "4"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ip"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "4"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "4"}], "<=", "0"}], ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "jp"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"j", "-", "4"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"cSym", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892379738819971*^9, 3.8923798167201433`*^9}, {
   3.892379861183041*^9, 3.89237990963455*^9}, {3.892380430675095*^9, 
   3.892380434831353*^9}, 3.8923827604801493`*^9},
 CellLabel->
  "In[132]:=",ExpressionUUID->"1eaf8389-5968-4c64-9af7-df1ab9f0d4e1"],

Cell[BoxData[
 RowBox[{"csym2d", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.892382764696948*^9, 3.892382769042691*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"8d8b24d0-fc41-48ad-b5e1-94256e56dc94"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"xnorm", "-", "ip"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"xnorm", "-", "ip"}], ")"}], "^", "2"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"xnorm", "-", "ip"}], ")"}], "^", "3"}]}], "}"}], ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c00", ",", "c01", ",", "c02", ",", "c03"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"c10", ",", "c11", ",", "c22", ",", "c13"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"c20", ",", "c21", ",", "c22", ",", "c23"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"c30", ",", "c31", ",", "c32", ",", "c33"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ".", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"(", 
        RowBox[{"ynorm", "-", "jp"}], ")"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ynorm", "-", "jp"}], ")"}], "^", "2"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ynorm", "-", "jp"}], ")"}], "^", "3"}]}], "}"}]}], ")"}]}], 
  "//", "Expand"}]], "Input",
 CellChangeTimes->{{3.8923816467247267`*^9, 3.892381665712842*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"ce0c2139-8813-4958-b5b0-63b3431a8ef4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "xnorm", ",", 
     RowBox[{"xnorm", "^", "2"}], ",", 
     RowBox[{"xnorm", "^", "3"}]}], "}"}], ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c00", ",", "c01", ",", "c02", ",", "c03"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"c10", ",", "c11", ",", "c22", ",", "c13"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"c20", ",", "c21", ",", "c22", ",", "c23"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"c30", ",", "c31", ",", "c32", ",", "c33"}], "}"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{"1", ",", "ynorm", ",", 
       RowBox[{"ynorm", "^", "2"}], ",", 
       RowBox[{"ynorm", "^", "3"}]}], "}"}]}], ")"}]}], "//", 
  "Expand"}]], "Input",
 CellChangeTimes->{{3.892398561921298*^9, 3.892398605488937*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"dbbca63c-ba49-4c12-b890-ab5d8db44bf9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "xnorm", ",", 
      RowBox[{"xnorm", "^", "2"}], ",", 
      RowBox[{"xnorm", "^", "3"}]}], "}"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "8", "]"}], "]"}], ",", 
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "10", "]"}], "]"}], ",", 
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "12", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "9", "]"}], "]"}], ",", 
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "13", "]"}], "]"}], ",", 
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "15", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "6", "]"}], "]"}], ",", 
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "11", "]"}], "]"}], ",", 
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "14", "]"}], "]"}], ",", 
          RowBox[{"csym2d", "[", 
           RowBox[{"[", "16", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "}"}], ".", 
      RowBox[{"{", 
       RowBox[{"1", ",", "ynorm", ",", 
        RowBox[{"ynorm", "^", "2"}], ",", 
        RowBox[{"ynorm", "^", "3"}]}], "}"}]}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"xnorm", "-", "ip"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xnorm", "-", "ip"}], ")"}], "^", "2"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xnorm", "-", "ip"}], ")"}], "^", "3"}]}], "}"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c00", ",", "c01", ",", "c02", ",", "c03"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"c10", ",", "c11", ",", "c12", ",", "c13"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"c20", ",", "c21", ",", "c22", ",", "c23"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"c30", ",", "c31", ",", "c32", ",", "c33"}], "}"}]}], 
       "\[IndentingNewLine]", "}"}], ".", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"(", 
         RowBox[{"ynorm", "-", "jp"}], ")"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ynorm", "-", "jp"}], ")"}], "^", "2"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ynorm", "-", "jp"}], ")"}], "^", "3"}]}], "}"}]}], 
     ")"}]}]}], "//", "Expand"}]], "Input",
 CellChangeTimes->{{3.8923804803102016`*^9, 3.8923805810341454`*^9}, {
  3.892381094240156*^9, 3.892381095239676*^9}, {3.892381367641354*^9, 
  3.892381385385779*^9}, {3.8923815590604753`*^9, 3.89238161792974*^9}, {
  3.89238168358298*^9, 3.892381683928941*^9}, {3.892381719147559*^9, 
  3.892381719604107*^9}, {3.892382619750865*^9, 3.892382626695334*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"849e0dc5-5a6a-4d89-942e-41c56b73979c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"c2d", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "1"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "1"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "2"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "2"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "1"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"j", "-", "1"}], ")"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "1"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "2"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], 
           "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "3"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "3"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "1"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], 
           "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "1"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "3"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "3"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"i", "-", "3"}], ",", "0"}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "4"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "4"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "1"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"j", "-", "3"}], ",", "0"}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "1"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "4"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "4"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"j", "-", "1"}], ")"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "2"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "2"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "2"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], 
           "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"j", "-", "1"}], ")"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "3"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "3"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "2"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "*", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], 
           "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "2"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "2"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "3"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "3"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"i", "-", "3"}], ",", "0"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"j", "-", "1"}], ")"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "4"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "4"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "2"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "*", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"j", "-", "3"}], ",", "0"}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "2"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "2"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "4"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "4"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], 
           "]"}], "*", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], 
           "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "3"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "3"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "3"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "3"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"i", "-", "3"}], ",", "0"}], "]"}], "*", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], 
           "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "4"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "4"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "3"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "3"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "-", "3"}], ",", "0"}], 
           "]"}], "*", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"j", "-", "3"}], ",", "0"}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "3"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "3"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "4"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "4"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"i", "-", "3"}], ",", "0"}], "]"}], "*", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"j", "-", "3"}], ",", "0"}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "-", "4"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ip"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "4"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "-", "4"}], "<=", "0"}], ",", "1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "jp"}], "+", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"j", "-", "4"}], ")"}]}]}], "]"}], "*", 
          RowBox[{"coefficents", "[", 
           RowBox[{"[", 
            RowBox[{"ip", ",", "jp", ",", "i", ",", "j"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ip", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jp", ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8921593660647573`*^9, 3.8921594319355*^9}, {
   3.89215954929734*^9, 3.892159813843912*^9}, {3.89215986936473*^9, 
   3.892159870165436*^9}, {3.89215990396144*^9, 3.892159993283758*^9}, 
   3.892160034034506*^9, {3.892160078604294*^9, 3.892160264371192*^9}, {
   3.892160304798852*^9, 3.892160374239987*^9}, {3.892192639531151*^9, 
   3.892192658877552*^9}, {3.8923745783269444`*^9, 3.892375165066884*^9}, {
   3.8923753059544973`*^9, 3.89237530612364*^9}, {3.892375556470916*^9, 
   3.892375606930293*^9}, {3.89237571752236*^9, 3.892375723475554*^9}, {
   3.892375888364667*^9, 3.892375893667637*^9}, {3.892377243514187*^9, 
   3.892377291717671*^9}, {3.892377448280254*^9, 3.892377496844121*^9}, {
   3.8923785360587473`*^9, 3.892378545081181*^9}, {3.892378747919965*^9, 
   3.892378778093771*^9}, {3.8923793638103113`*^9, 3.892379367897807*^9}, {
   3.892398252556694*^9, 3.892398299118004*^9}, {3.892400295863536*^9, 
   3.8924003874841967`*^9}, {3.8924004539461937`*^9, 3.892400516289729*^9}, {
   3.892400561912528*^9, 3.892400617521698*^9}, {3.8924006795546494`*^9, 
   3.892400706305072*^9}, {3.892400760173368*^9, 3.892400776517706*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"3fcea19b-1a40-47bd-a8d7-290a77e19bcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f2", "[", 
     RowBox[{"xmin_", ",", "ymin_"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ilow", ",", "xnorm", ",", "jlow", ",", "ynorm", ",", "a"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ilow", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "-", "xmin"}], ")"}], "/", "dx"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "2"}]}], "]"}], ",", 
         "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xnorm", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "xmin"}], ")"}], "/", "dx"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"jlow", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"y", "-", "ymin"}], ")"}], "/", "dy"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "2"}]}], "]"}], ",", 
         "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ynorm", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", "ymin"}], ")"}], "/", "dy"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"5", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"7", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"8", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"10", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"12", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"9", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"13", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"15", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"6", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"11", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"14", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"16", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dx", ",", "ilow", ",", "xnorm"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"dy", ",", "jlow", ",", "ynorm"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "xnorm", ",", 
           RowBox[{"xnorm", "^", "2"}], ",", 
           RowBox[{"xnorm", "^", "3"}]}], "}"}], ".", 
         RowBox[{"(", 
          RowBox[{"a", ".", 
           RowBox[{"{", 
            RowBox[{"1", ",", "ynorm", ",", 
             RowBox[{"ynorm", "^", "2"}], ",", 
             RowBox[{"ynorm", "^", "3"}]}], "}"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"a", "//", "MatrixForm"}]}], "\[IndentingNewLine]", "}"}]}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.89202619614089*^9, 3.8920261992221317`*^9}, {
   3.89202624135054*^9, 3.892026361653056*^9}, {3.8920263965945797`*^9, 
   3.892026433484888*^9}, {3.892026497702795*^9, 3.892026511809936*^9}, {
   3.892026749659067*^9, 3.892026754868867*^9}, {3.892026824029242*^9, 
   3.892026844702982*^9}, {3.892026877988647*^9, 3.892026956445263*^9}, {
   3.8920270493145847`*^9, 3.892027055798732*^9}, {3.89202777836502*^9, 
   3.892027787816286*^9}, {3.8920313947607107`*^9, 3.892031403320284*^9}, {
   3.892031438051106*^9, 3.892031490434355*^9}, {3.8920317245951853`*^9, 
   3.892031797611106*^9}, {3.8920319528295307`*^9, 3.892031956515471*^9}, {
   3.892033955578188*^9, 3.892033957389639*^9}, {3.892034007785977*^9, 
   3.892034012356469*^9}, {3.892034411473446*^9, 3.892034417357777*^9}, {
   3.892034816640399*^9, 3.892034818327484*^9}, {3.8920348622408857`*^9, 
   3.892034875106597*^9}, {3.892034923695199*^9, 3.892034983802092*^9}, {
   3.8920350196896753`*^9, 3.8920350220362062`*^9}, {3.8920355385756493`*^9, 
   3.89203555882578*^9}, {3.892035593214167*^9, 3.8920355950015793`*^9}, {
   3.892037123239149*^9, 3.892037123355411*^9}, {3.892044660086939*^9, 
   3.892044699399912*^9}, {3.892044968549802*^9, 3.892044974001501*^9}, {
   3.892046021280211*^9, 3.892046027667212*^9}, {3.8920460658592243`*^9, 
   3.8920460817973003`*^9}, {3.892046113407345*^9, 3.892046124237948*^9}, {
   3.892372816532975*^9, 3.8923729581736317`*^9}, {3.89237300608643*^9, 
   3.8923730127857647`*^9}, {3.892373074113124*^9, 3.892373199008552*^9}, {
   3.892373236450447*^9, 3.892373309448346*^9}, {3.892373706198885*^9, 
   3.892373721798539*^9}, {3.892374114338138*^9, 3.892374181651463*^9}, {
   3.892374267964232*^9, 3.892374268226891*^9}, {3.892374301132964*^9, 
   3.892374309835011*^9}, {3.89237436343293*^9, 3.892374372051217*^9}, {
   3.892374423023859*^9, 3.892374430184355*^9}, {3.892375369290502*^9, 
   3.892375371071062*^9}, {3.892375483269834*^9, 3.892375483794272*^9}, {
   3.8923760230528107`*^9, 3.8923762380959063`*^9}, {3.892376309369669*^9, 
   3.892376357706102*^9}, {3.8923764220179243`*^9, 3.892376464575006*^9}, {
   3.8923767229858313`*^9, 3.892376728218988*^9}, {3.892377391474504*^9, 
   3.892377392964775*^9}, {3.892377516780428*^9, 3.892377523984174*^9}, {
   3.892377582848559*^9, 3.8923775863588867`*^9}, {3.892377897801866*^9, 
   3.892377899693467*^9}, {3.892378104325399*^9, 3.892378149009131*^9}, {
   3.892378882501916*^9, 3.892378916385336*^9}, {3.892378965824976*^9, 
   3.892378981014086*^9}, {3.892379406936639*^9, 3.892379413610141*^9}, 
   3.8923794440622168`*^9, {3.892381258833106*^9, 3.89238126224618*^9}, {
   3.892382075707711*^9, 3.8923820818212643`*^9}, {3.892382146863422*^9, 
   3.89238214852494*^9}, {3.892382562667137*^9, 3.892382566384701*^9}, {
   3.892383101812769*^9, 3.8923831409867353`*^9}, {3.892383279017785*^9, 
   3.8923833002405787`*^9}, {3.892397796973461*^9, 3.892397806235044*^9}, {
   3.892398332375203*^9, 3.89239834454714*^9}, {3.8923986204107323`*^9, 
   3.892398624034067*^9}, {3.892398669560471*^9, 3.892398671590872*^9}, 
   3.892399326239482*^9, {3.892400642670355*^9, 3.892400644650015*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"dfa41d54-17bf-4038-b1ef-77a66d1666d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f2dx", "[", 
     RowBox[{"xmin_", ",", "ymin_"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ilow", ",", "xnorm", ",", "jlow", ",", "ynorm", ",", "a"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ilow", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "-", "xmin"}], ")"}], "/", "dx"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "2"}]}], "]"}], ",", 
         "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xnorm", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "xmin"}], ")"}], "/", "dx"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"jlow", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"y", "-", "ymin"}], ")"}], "/", "dy"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "2"}]}], "]"}], ",", 
         "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ynorm", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", "ymin"}], ")"}], "/", "dy"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"8", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"10", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"12", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"9", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"13", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"15", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"6", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"11", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"14", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"16", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dx", ",", "ilow", ",", "xnorm"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"dy", ",", "jlow", ",", "ynorm"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"2", "*", "xnorm"}], ",", 
             RowBox[{"3", "*", 
              RowBox[{"xnorm", "^", "2"}]}]}], "}"}], "/", "dx"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"a", ".", 
           RowBox[{"{", 
            RowBox[{"1", ",", "ynorm", ",", 
             RowBox[{"ynorm", "^", "2"}], ",", 
             RowBox[{"ynorm", "^", "3"}]}], "}"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"a", "//", "MatrixForm"}]}], "\[IndentingNewLine]", "}"}]}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8932267735743017`*^9, 3.8932267737469997`*^9}, {
  3.893226889535748*^9, 3.893226921431857*^9}, {3.893227170095682*^9, 
  3.893227178484714*^9}, {3.8932488504059753`*^9, 3.8932488531495733`*^9}, {
  3.893928603503162*^9, 3.8939286109371233`*^9}, {3.893929361637384*^9, 
  3.893929361907015*^9}, {3.893930534432136*^9, 3.893930535149024*^9}, {
  3.893931027397456*^9, 3.893931029648694*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"c4414f44-633e-4ff2-a6a8-2be0a11467f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f2dy", "[", 
     RowBox[{"xmin_", ",", "ymin_"}], "]"}], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ilow", ",", "xnorm", ",", "jlow", ",", "ynorm", ",", "a"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ilow", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "-", "xmin"}], ")"}], "/", "dx"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", "xGrid", "]"}], "-", "2"}]}], "]"}], ",", 
         "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xnorm", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "xmin"}], ")"}], "/", "dx"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"jlow", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"y", "-", "ymin"}], ")"}], "/", "dy"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", "yGrid", "]"}], "-", "2"}]}], "]"}], ",", 
         "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ynorm", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", "ymin"}], ")"}], "/", "dy"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"5", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"7", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"8", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"10", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"12", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"9", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"13", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"15", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"11", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"14", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"c2d", "[", 
            RowBox[{"[", 
             RowBox[{"16", ",", 
              RowBox[{"ilow", "+", "1"}], ",", 
              RowBox[{"jlow", "+", "1"}]}], "]"}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dx", ",", "ilow", ",", "xnorm"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"dy", ",", "jlow", ",", "ynorm"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "xnorm", ",", 
           RowBox[{"xnorm", "^", "2"}], ",", 
           RowBox[{"xnorm", "^", "3"}]}], "}"}], ".", 
         RowBox[{"(", 
          RowBox[{"a", ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"2", "*", "ynorm"}], ",", 
               RowBox[{"3", "*", 
                RowBox[{"ynorm", "^", "2"}]}]}], "}"}], "/", "dy"}], ")"}]}], 
          ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"a", "//", "MatrixForm"}]}], "\[IndentingNewLine]", "}"}]}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.893226876878792*^9, 3.893226882831801*^9}, 
   3.893226927436883*^9, 3.893227174885797*^9, {3.893248857297113*^9, 
   3.89324886001581*^9}, {3.8939286288238573`*^9, 3.893928634098559*^9}, {
   3.893929367149887*^9, 3.8939293675680647`*^9}, {3.893930551951639*^9, 
   3.893930553390376*^9}, {3.8939310366529303`*^9, 3.8939310390690393`*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"cc52bca1-0f40-4876-8d48-0c96e0e0ec95"],

Cell[BoxData[
 RowBox[{"ans", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"zmin", "==", 
        RowBox[{
         RowBox[{"mp", "*", "rleft"}], "+", "bp"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"zmax", "==", 
        RowBox[{
         RowBox[{"mp", "*", "rmax"}], "+", "bp"}]}]}], "\[IndentingNewLine]", 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"mp", ",", "bp"}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.892397538831815*^9, 3.892397592522627*^9}, {
  3.892397625997672*^9, 3.892397639333084*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"af510849-8698-4515-8ced-48c9bc6556e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"zcoodinate", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"mp", "*", "x"}], "+", "bp"}], "/.", "ans"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892397604999064*^9, 3.892397647196744*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"bdb6d979-6f9f-44cf-83f8-50583e4c2259"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"f2", "[", 
        RowBox[{"rleft", ",", "zmin"}], "]"}], "[", 
       RowBox[{"x", ",", 
        RowBox[{"zcoodinate", "[", "x", "]"}]}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Min", "[", "xGrid", "]"}], ",", 
       RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
     RowBox[{"PlotPoints", "->", "200"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"xGrid", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"zGrid", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "xGrid", "]"}]}], "}"}]}], "]"}]}], "}"}], 
     "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.892397722249288*^9, 3.8923977432559137`*^9}, {
  3.892399998781501*^9, 3.892399999327837*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"18c472b0-fe55-4561-9f86-fb214c0263d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"f2", "[", 
     RowBox[{"rleft", ",", "zmin"}], "]"}], "[", 
    RowBox[{
     RowBox[{"rleft", "+", 
      RowBox[{"64", "*", "dx"}]}], ",", "zmin"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8923991987485323`*^9, 3.892399257389916*^9}, {
   3.8923992966225348`*^9, 3.892399301452416*^9}, 3.8923993396363792`*^9},
 CellLabel->
  "In[144]:=",ExpressionUUID->"4cc7dd36-72d1-417b-b594-0c8677272741"],

Cell[BoxData[
 RowBox[{
  RowBox[{"temp", "[", 
   RowBox[{"[", "4", "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8923993666534977`*^9, 3.892399373989921*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"bf0c73a5-d9c8-44a5-a48e-daf090d8fc34"],

Cell[BoxData[{
 RowBox[{"temp", "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"temp", "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.892399407784006*^9, 3.8923994245490627`*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"a61d1889-d8fa-42cb-9056-f1ef3d8fc86f"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"f2", "[", 
          RowBox[{"rleft", ",", "zmin"}], "]"}], "[", 
         RowBox[{"x", ",", 
          RowBox[{"yGrid", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"Min", "[", "xGrid", "]"}], ",", 
         RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
       RowBox[{"AxesLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<x\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
       RowBox[{"PlotPoints", "->", "200"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"xGrid", ",", 
         RowBox[{"zGrid", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", ";;"}], "]"}], "]"}]}], "}"}], "]"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", 
     RowBox[{"Length", "[", "yGrid", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.892382353868347*^9, 3.892382484451426*^9}, {
   3.892383642609234*^9, 3.892383661675461*^9}, {3.8923976718408127`*^9, 
   3.892397694821484*^9}, {3.892399099550344*^9, 3.8923991397729883`*^9}, 
   3.8923992700325003`*^9, {3.8923999769128523`*^9, 3.8923999901728086`*^9}, {
   3.893929536787199*^9, 3.893929575624475*^9}, {3.893929614204115*^9, 
   3.893929620443812*^9}, {3.893929651081566*^9, 3.893929651337318*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"83d1ba0f-e208-4540-88ad-05d3611fdec2"],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{"zGrid", ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "xGrid", "]"}], ",", 
        RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "yGrid", "]"}], ",", 
        RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.893929691440857*^9, 3.893929740732143*^9}, {
  3.893931109636362*^9, 3.8939311164856977`*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"84a59c81-ad8c-4bc2-926e-7e2ece7c99a7"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"f2", "[", 
      RowBox[{"rleft", ",", "zmin"}], "]"}], "[", 
     RowBox[{"x", ",", "y"}], "]"}], "[", 
    RowBox[{"[", "3", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"Min", "[", "xGrid", "]"}], ",", 
     RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"Min", "[", "yGrid", "]"}], ",", 
     RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}], ",", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
   
   RowBox[{"PlotPoints", "->", "400"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892381806719894*^9, 3.8923818254284554`*^9}, {
  3.892381872680101*^9, 3.89238190112994*^9}, {3.892381937320182*^9, 
  3.892381940539515*^9}, {3.892382016468214*^9, 3.892382016601379*^9}, {
  3.89240137389826*^9, 3.892401373990594*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"480d842f-96f0-4043-b5c7-5fb37dbd1335"],

Cell[BoxData[
 RowBox[{"ContourPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"f2", "[", 
      RowBox[{"rleft", ",", "zmin"}], "]"}], "[", 
     RowBox[{"x", ",", "y"}], "]"}], "[", 
    RowBox[{"[", "3", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"Min", "[", "xGrid", "]"}], ",", 
     RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"Min", "[", "yGrid", "]"}], ",", 
     RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
   RowBox[{"ContourShading", "->", "None"}], ",", " ", 
   RowBox[{"Contours", "->", "100"}], ",", 
   RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
   RowBox[{"PlotPoints", "->", "200"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892026980154975*^9, 3.892027027627183*^9}, {
   3.892027378729082*^9, 3.89202739327151*^9}, {3.892027834436687*^9, 
   3.89202786930882*^9}, {3.892031184752586*^9, 3.892031185675766*^9}, {
   3.892034461405251*^9, 3.892034462767817*^9}, 3.8920345003138*^9, {
   3.892034557829143*^9, 3.892034568499135*^9}, 3.892034608485338*^9, {
   3.8920347107392607`*^9, 3.892034734040133*^9}, {3.892034766585705*^9, 
   3.892034766751584*^9}, 3.892035055820632*^9, {3.89204471910373*^9, 
   3.892044782672399*^9}, {3.892044819430623*^9, 3.892044821757121*^9}, {
   3.892044859437182*^9, 3.892044928441716*^9}, {3.8920450165594797`*^9, 
   3.892045038043914*^9}, {3.8920455936961327`*^9, 3.892045598646699*^9}, {
   3.892045893077004*^9, 3.892045895885291*^9}, {3.892046792088759*^9, 
   3.892046810125736*^9}, {3.892047507172145*^9, 3.892047528446258*^9}, 
   3.892374331111597*^9, 3.892401102854841*^9},
 CellLabel->
  "In[151]:=",ExpressionUUID->"662a832f-7d6f-4445-a977-c3bb640ef588"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "dx", "]"}], "[", 
         RowBox[{"fpol", "/", "xGrid"}], "]"}], "[", "rleft", "]"}], "[", "x",
        "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Min", "[", "xGrid", "]"}], ",", 
       RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"xGrid", ",", 
       RowBox[{"fpol", "/", "xGrid"}]}], "}"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8920495890943727`*^9, 3.892049611424694*^9}, {
   3.892049658195211*^9, 3.89204966281277*^9}, 3.8923724848429527`*^9},
 CellLabel->
  "In[152]:=",ExpressionUUID->"a423f5b1-3b16-46d9-98f8-290b44204552"],

Cell[BoxData[
 RowBox[{"dpsi", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"psibry", "-", 
     RowBox[{"Min", "[", "psi", "]"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"65", "-", "1"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.892156852443334*^9, 3.8921568942703133`*^9}, {
   3.8921571586018867`*^9, 3.8921571610281153`*^9}, 3.932567164999435*^9, 
   3.932568314616386*^9},
 CellLabel->
  "In[153]:=",ExpressionUUID->"5f0d7cbf-90a2-4bb8-a509-f6dac008fa55"],

Cell[BoxData[
 RowBox[{"numpsi", "=", 
  RowBox[{
   RowBox[{"Ceiling", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Max", "[", "psi", "]"}], "-", 
       RowBox[{"Min", "[", "psi", "]"}]}], ")"}], "/", "dpsi"}], "]"}], "+", 
   "1"}]}]], "Input",
 CellChangeTimes->{{3.892156908078453*^9, 3.892156934045126*^9}, {
   3.892156986161022*^9, 3.892156989296597*^9}, {3.892157190003104*^9, 
   3.8921571904112387`*^9}, {3.932567190477564*^9, 3.9325671932646914`*^9}, 
   3.932568319940658*^9},
 CellLabel->
  "In[154]:=",ExpressionUUID->"ab769e9f-51cf-47b0-b079-168e30e016d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psi1D", "=", 
   RowBox[{"Subdivide", "[", 
    RowBox[{
     RowBox[{"Min", "[", "psi", "]"}], ",", 
     RowBox[{"Max", "[", "psi", "]"}], ",", 
     RowBox[{"numpsi", "-", "1"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892156998901184*^9, 3.892157030497807*^9}, {
   3.892157141877824*^9, 3.892157142001883*^9}, {3.892157177670187*^9, 
   3.892157193876917*^9}, 3.932567202705923*^9, 3.93256832172148*^9},
 CellLabel->
  "In[155]:=",ExpressionUUID->"af973acb-c750-48fc-aa9e-69d2efc6fc78"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psi1D", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "-", 
  RowBox[{"psi1D", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8921571313752947`*^9, 3.8921571370235643`*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"1ca54424-e6db-439b-9a02-c1caac040785"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"profile", "[", "s_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"s", ">", "1"}], ",", "0", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"s", "^", "5.0"}]}], ")"}], "^", "2.0"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.892157453576806*^9, 3.892157504749379*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"4430efcf-62a3-49fd-a47f-13f1f9a5e767"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans2", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "==", 
       RowBox[{
        RowBox[{"mp", "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Min", "[", "psi", "]"}], ",", "psibry"}], "}"}]}], "+", 
        "bp"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"mp", ",", "bp"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8924038264988337`*^9, 3.892403914954955*^9}, 
   3.892404057762003*^9, 3.932567212186451*^9, 3.93256832310086*^9},
 CellLabel->
  "In[158]:=",ExpressionUUID->"93194afd-c4de-4dd3-a575-ad39677f9716"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psinorm", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mp", "*", "#"}], "+", "bp"}], "&"}], ",", "psi1D"}], "]"}], "/.",
     "ans2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8921575419775553`*^9, 3.892157616391326*^9}, {
   3.8924039289804173`*^9, 3.8924039842726917`*^9}, 3.8924040843590107`*^9},
 CellLabel->
  "In[159]:=",ExpressionUUID->"a5885a62-43a5-49d4-b64f-d82769bd41a3"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", "dpsi", "]"}], "[", "pres", "]"}], "[", 
       RowBox[{"Min", "[", "psi", "]"}], "]"}], "[", "x", "]"}], "[", 
     RowBox[{"[", "4", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"Min", "[", "psi", "]"}], ",", "psibry"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8921588239385*^9, 3.892158906242518*^9}, 
   3.892372495852943*^9},
 CellLabel->
  "In[160]:=",ExpressionUUID->"2e9d45da-d368-4a09-b687-0a4868a2bed2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"predGrid", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#", ">", "psibry"}], ",", "0", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"f", "[", "dpsi", "]"}], "[", "pres", "]"}], "[", 
            RowBox[{"Min", "[", "psi", "]"}], "]"}], "[", "#", "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "&"}], ",", "psi1D"}], 
     "]"}], "/", 
    RowBox[{"Max", "[", "pres", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8921589363791523`*^9, 3.892159003481153*^9}, 
   3.892372501154036*^9, {3.892468193086273*^9, 3.892468198266327*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"7fb8f17b-3837-4095-bf9b-2228fff9a78d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fpolGrid", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"#", ">", "psibry"}], ",", 
        RowBox[{"r0", "*", "b0"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"f", "[", "dpsi", "]"}], "[", "fpol", "]"}], "[", 
           RowBox[{"Min", "[", "psi", "]"}], "]"}], "[", "#", "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "&"}], ",", "psi1D"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.954951428091926*^9, 3.95495147968526*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"0f1701b6-d244-4027-b911-78ab07a198d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"factor", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#", ">", "psibry"}], ",", "0", ",", "1"}], "]"}], "&"}], 
      ",", "psi1D"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{";;", 
      RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.897576451477132*^9, 3.897576522416953*^9}, {
  3.897576645451784*^9, 3.897576672984479*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"256cb068-2afb-4894-b792-19cea82acbe1"],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{"psi1D", ",", "predGrid"}], "}"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.892159007796877*^9, 3.892159025866343*^9}, {
  3.897576531693013*^9, 3.8975765555796947`*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"d1af4aa1-1905-479a-b502-3f7211e17976"],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{"psi1D", ",", "fpolGrid"}], "}"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{3.954951499516573*^9},
 CellLabel->
  "In[176]:=",ExpressionUUID->"9d9804c0-2e4c-41bf-9130-316bc1371355"],

Cell[BoxData[
 RowBox[{"Min", "[", "psinorm", "]"}]], "Input",
 CellChangeTimes->{{3.8924035899088097`*^9, 3.892403597180642*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"aa58b1d8-67f9-4221-a90e-bad687ba31df"],

Cell[BoxData[
 RowBox[{"Max", "[", "psinorm", "]"}]], "Input",
 CellChangeTimes->{{3.8924036031041737`*^9, 3.892403605055887*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"d3ac8609-71af-4e7b-875a-e4f2ddb61132"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"neGrid", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"profile", "[", "#", "]"}], "&"}], ",", "psinorm"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"teGrid", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"profile", "[", "#", "]"}], "&"}], ",", "psinorm"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.892157727200337*^9, 3.892157741749794*^9}, 
   3.8924679822899723`*^9, {3.8924680323428097`*^9, 3.8924680346582937`*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"4d71df79-739f-4678-814a-a6ca1409f7f8"],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"psinorm", ",", "psi1D"}], "}"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "psinorm", "]"}], ",", "psibry"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", "psinorm", "]"}], ",", "psibry"}], "}"}]}], 
     "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8924036845193644`*^9, 3.892403784009985*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"a26c9bf6-5ebd-4676-9af0-8906cec52ead"],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{"psinorm", ",", "neGrid"}], "}"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{3.892403662966399*^9},
 CellLabel->
  "In[169]:=",ExpressionUUID->"5973f11d-6524-48d2-b45e-7e6df47960f8"],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{"psi1D", ",", "neGrid"}], "}"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8921570367873697`*^9, 3.892157059720043*^9}, {
   3.892157626084818*^9, 3.892157698851056*^9}, 3.892157753178235*^9},
 CellLabel->
  "In[170]:=",ExpressionUUID->"147bc25a-1dbe-4640-8768-98bdabc15469"],

Cell[BoxData[
 RowBox[{"MinMax", "[", "neGrid", "]"}]], "Input",
 CellChangeTimes->{{3.8924637427845173`*^9, 3.8924637485788307`*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"2c403dbb-4e8e-4165-8650-f90944ac47d6"],

Cell[BoxData[
 RowBox[{"MinMax", "[", "psi", "]"}]], "Input",
 CellChangeTimes->{{3.892463762726448*^9, 3.892463768346067*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"a759e04b-b11d-4dbf-b87c-19997c71af4c"],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{"psi1D", ",", "teGrid"}], "}"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8921577133199377`*^9, 3.892157713426284*^9}, 
   3.8921577591858673`*^9},
 CellLabel->
  "In[173]:=",ExpressionUUID->"bf3775d0-fdd5-4785-94d9-5b87f89e347b"],

Cell[BoxData[
 RowBox[{"MinMax", "[", "teGrid", "]"}]], "Input",
 CellChangeTimes->{{3.8924637357067623`*^9, 3.8924637385168*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"33f2027f-6234-4648-aa03-90dfd79803d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fpolc", "=", 
   RowBox[{"c1D", "[", "fpolGrid", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892157839126211*^9, 3.892157841570117*^9}, {
  3.892158522435544*^9, 3.892158531225295*^9}, {3.892158563348682*^9, 
  3.892158578689258*^9}, {3.9549515422937517`*^9, 3.954951543124847*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"781cd006-8552-43e3-ae8b-8a8fbdfb9e8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"presc", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "*", "factor"}], "&"}], ",", 
     RowBox[{"c1D", "[", "predGrid", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8921590531232853`*^9, 3.892159091588751*^9}, {
   3.897576580085012*^9, 3.897576604562994*^9}, 3.8975767053035927`*^9},
 CellLabel->
  "In[178]:=",ExpressionUUID->"2d455eb8-b1e1-4072-aac1-7a51b9496e1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nec", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "*", "factor"}], "&"}], ",", 
     RowBox[{"c1D", "[", "neGrid", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892159135435892*^9, 3.892159143685273*^9}, {
  3.897576718204156*^9, 3.8975767220685253`*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"0613254b-03f4-4583-9ece-e4bbcac1c872"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tec", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "*", "factor"}], "&"}], ",", 
     RowBox[{"c1D", "[", "teGrid", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892159193702167*^9, 3.892159195825019*^9}, {
  3.897576726594499*^9, 3.8975767435016327`*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"ae80f178-55c1-4104-942e-8add5e71752d"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "c2d", "]"}]], "Input",
 CellChangeTimes->{{3.8923725256435738`*^9, 3.8923725412574253`*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"424a7048-3395-437a-86d9-0259728ed421"],

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"fpolc", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.892192444622375*^9, 3.892192465502906*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"b13efb3f-043f-4966-be57-175ef149a31a"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"c2d", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.892192602744227*^9, 3.892192615655282*^9}, {
  3.892192708188484*^9, 3.892192711432695*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"d8085591-af12-48f3-b638-1cc3ac933e60"],

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"tec", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.901706270419544*^9, 3.901706282221191*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"ee5564de-739c-4f62-aaf8-7b6bef0f4acb"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<efit.nc\>\"", ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Dimensions\>\"", "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<numr\>\"", "->", "64"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<numz\>\"", "->", "64"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<numpsi\>\"", "->", 
         RowBox[{"numpsi", "-", "1"}]}]}], "\[IndentingNewLine]", "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Datasets\>\"", "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<rmin\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Data\>\"", "->", "rleft"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<dr\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Data\>\"", "->", 
           RowBox[{
            RowBox[{"xGrid", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"xGrid", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<zmin\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Data\>\"", "->", "zmin"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<dz\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Data\>\"", "->", 
           RowBox[{
            RowBox[{"yGrid", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"yGrid", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<psimin\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Data\>\"", "->", 
           RowBox[{"Min", "[", "psi", "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<psibry\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Data\>\"", "->", "psibry"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<dpsi\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Data\>\"", "->", 
           RowBox[{
            RowBox[{"psi1D", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"psi1D", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<fpol_c0\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"fpolc", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<fpol_c1\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"fpolc", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<fpol_c2\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"fpolc", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<fpol_c3\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"fpolc", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<pres_scale\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Data\>\"", "->", 
           RowBox[{"Max", "[", "pres", "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<pressure_c0\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"presc", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<pressure_c1\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"presc", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<pressure_c2\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"presc", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<pressure_c3\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"presc", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<ne_scale\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Data\>\"", "->", 
           RowBox[{"Max", "[", "ne", "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<ne_c0\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"nec", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<ne_c1\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"nec", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<ne_c2\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"nec", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<ne_c3\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"nec", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<te_scale\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Data\>\"", "->", 
           RowBox[{"Max", "[", "te", "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<te_c0\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"tec", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<te_c1\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"tec", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<te_c2\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"tec", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<te_c3\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"tec", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", "\"\<numpsi\>\""}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c00\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c10\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c01\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c20\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c02\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c30\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c03\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c11\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "8", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c21\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "9", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c12\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "10", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c31\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "11", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c13\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "12", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c22\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "13", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c32\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "14", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c23\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "15", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<psi_c33\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Data\>\"", "->", 
            RowBox[{"c2d", "[", 
             RowBox[{"[", "16", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<DimensionNames\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<numr\>\"", ",", "\"\<numz\>\""}], "}"}]}]}], 
          "}"}]}]}], "\[IndentingNewLine]", "}"}]}]}], "}"}], ",", 
   "\"\<Rules\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.8921566808935137`*^9, 3.8921567131851187`*^9}, {
   3.8921567499914923`*^9, 3.892156807335429*^9}, {3.892156887096344*^9, 
   3.892156888089237*^9}, {3.892156947069615*^9, 3.892156950057132*^9}, 
   3.892157205298237*^9, {3.892157782018915*^9, 3.892157992229368*^9}, {
   3.892158587453457*^9, 3.892158629030179*^9}, {3.892159049584127*^9, 
   3.8921590498120747`*^9}, {3.8921591035624437`*^9, 3.892159173212981*^9}, {
   3.892159203334064*^9, 3.892159224920001*^9}, {3.8921603870588303`*^9, 
   3.8921604739249563`*^9}, {3.892160524687549*^9, 3.8921607018145447`*^9}, 
   3.892160892847299*^9, {3.892160967785534*^9, 3.892161000243585*^9}, 
   3.892161051161335*^9, {3.892161102205165*^9, 3.892161104381158*^9}, {
   3.892192472380698*^9, 3.892192473410996*^9}, {3.892192902898869*^9, 
   3.892192934906125*^9}, {3.892467990477789*^9, 3.892468025237541*^9}, {
   3.89246822983298*^9, 3.892468238358341*^9}, {3.89262746021113*^9, 
   3.8926274653946047`*^9}, 3.893766987959653*^9, {3.8958499648480062`*^9, 
   3.895850001959592*^9}, 3.895850219838068*^9, {3.895851714708386*^9, 
   3.895851714888957*^9}, {3.895851763785344*^9, 3.895851766706964*^9}, {
   3.901706329064941*^9, 3.901706329334696*^9}, {3.93213700749286*^9, 
   3.932137048118009*^9}, 3.932567915580364*^9, 3.93256832628615*^9, {
   3.954951563043166*^9, 3.954951565546887*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"b0b7d2d3-1c0b-443e-a311-5b82c9836e99"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ray Result", "Section",
 CellChangeTimes->{{3.892713665339499*^9, 
  3.892713670442336*^9}},ExpressionUUID->"29c9a5c5-96a3-44dd-8275-\
164bcd67bc39"],

Cell[BoxData[
 RowBox[{"rayfile", "=", 
  RowBox[{"SystemDialogInput", "[", "\"\<FileOpen\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.8927136727224007`*^9, 3.892713683203393*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"502c5a16-5fff-4e72-9725-64b74dffe2a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Import", "[", 
      RowBox[{"rayfile", ",", "\"\<Data\>\""}], "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8927137070654907`*^9, 3.892713741095456*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"ed140988-d230-4888-8966-7eb3cd1e8c9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fne", "[", 
    RowBox[{"r_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Max", "[", "ne", "]"}], "*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", "dpsi", "]"}], "[", "neGrid", "]"}], "[", 
       RowBox[{"Min", "[", "psi", "]"}], "]"}], "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f2", "[", 
         RowBox[{"rleft", ",", "zmin"}], "]"}], "[", 
        RowBox[{"r", ",", "z"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}], "[", 
     RowBox[{"[", "4", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.893176193381524*^9, 3.893176227784409*^9}, 
   3.893176283696431*^9, {3.893176336279327*^9, 3.8931763416742887`*^9}, {
   3.8931763839270897`*^9, 3.893176436365594*^9}, {3.893176635099575*^9, 
   3.893176636071331*^9}, {3.893176680038199*^9, 3.893176682079515*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"165b940c-6e23-49b0-8bea-021792700c0b"],

Cell[BoxData[{
 RowBox[{"q", "=", "1.602176634*^-19"}], "\[IndentingNewLine]", 
 RowBox[{"me", "=", "9.1093837015*^-31"}], "\[IndentingNewLine]", 
 RowBox[{"\[Epsilon]0", "=", "8.8541878138*^-12"}], "\[IndentingNewLine]", 
 RowBox[{"\[Mu]0", "=", 
  RowBox[{"Pi", "*", "4.0*^-7"}]}], "\[IndentingNewLine]", 
 RowBox[{"c", "=", 
  RowBox[{"1", "/", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"\[Epsilon]0", "*", "\[Mu]0"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8931772426636353`*^9, 3.893177243163225*^9}, {
   3.893177288704111*^9, 3.893177435087533*^9}, 3.893768578285289*^9, {
   3.893768704697435*^9, 3.89376871072495*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"d57853a8-a581-46a7-9900-d46ed47db381"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]pe", "[", 
    RowBox[{"r_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"fne", "[", 
      RowBox[{"r", ",", "z"}], "]"}], "*", "q", "*", 
     RowBox[{"q", "/", 
      RowBox[{"(", 
       RowBox[{"\[Epsilon]0", "*", "me", "*", "c", "*", "c"}], ")"}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8931772256310997`*^9, 3.893177241267997*^9}, {
  3.893177299644945*^9, 3.893177300795952*^9}, {3.893177454186976*^9, 
  3.893177477857606*^9}, {3.8931821912257767`*^9, 3.893182199490684*^9}, {
  3.893183804764035*^9, 3.893183806404956*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"3a608216-8b3c-4353-836c-bb9fcc820f15"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bvec", "[", 
    RowBox[{"r_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"f2dy", "[", 
         RowBox[{"rleft", ",", "zmin"}], "]"}], "[", 
        RowBox[{"r", ",", "z"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "/", "r"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "dx", "]"}], "[", "fpol", "]"}], "[", "rleft", 
         "]"}], "[", "r", "]"}], "[", 
       RowBox[{"[", "4", "]"}], "]"}], "/", "r"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        RowBox[{
         RowBox[{"f2dx", "[", 
          RowBox[{"rleft", ",", "zmin"}], "]"}], "[", 
         RowBox[{"r", ",", "z"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "/", "r"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.893181754149006*^9, 3.8931817592769203`*^9}, {
   3.893181793862914*^9, 3.893181795861191*^9}, {3.893181830836769*^9, 
   3.893181902764285*^9}, {3.8931819492184772`*^9, 3.8931820204699297`*^9}, {
   3.893189646671596*^9, 3.893189659506597*^9}, {3.8931897087370253`*^9, 
   3.893189752182317*^9}, {3.893189811744708*^9, 3.893189879560416*^9}, {
   3.8931899192258167`*^9, 3.893189942192113*^9}, {3.893190024956449*^9, 
   3.893190032883938*^9}, {3.893226970237733*^9, 3.893227022660955*^9}, {
   3.8932272287932787`*^9, 3.893227231184567*^9}, {3.8932390940889072`*^9, 
   3.8932390950190887`*^9}, {3.893245222588006*^9, 3.89324522552976*^9}, {
   3.8932453069196587`*^9, 3.89324531041504*^9}, 3.893245425018609*^9, {
   3.893245561097836*^9, 3.89324556311263*^9}, {3.893248517171021*^9, 
   3.893248519120164*^9}, 3.893249908857806*^9, {3.893771642085464*^9, 
   3.893771649228965*^9}, {3.893929834638804*^9, 3.89392985100996*^9}, {
   3.8939309602364283`*^9, 3.8939309685981417`*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"1c7c1ad1-5d1d-4a9c-893e-70f439c1e76f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bmod", "[", 
    RowBox[{"r_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"bvec", "[", 
      RowBox[{"r", ",", "z"}], "]"}], ".", 
     RowBox[{"bvec", "[", 
      RowBox[{"r", ",", "z"}], "]"}]}], "]"}]}], ";", 
  SubscriptBox["\[SelectionPlaceholder]", "\[Placeholder]"]}]], "Input",
 CellChangeTimes->{{3.893182025393837*^9, 3.893182048193247*^9}, {
   3.893182088285739*^9, 3.893182089226501*^9}, 
   3.8941177374580927`*^9},ExpressionUUID->"8f68d4d0-7369-44f1-8064-\
cdb64504bac6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bhat", "[", 
    RowBox[{"r_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"bvec", "[", 
     RowBox[{"r", ",", "z"}], "]"}], "/", 
    RowBox[{"bmod", "[", 
     RowBox[{"r", ",", "z"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.893255307980304*^9, 3.893255329695239*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"3ac34c4b-bf7c-486b-aa81-0efc45ed437d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalOmega]ce", "[", 
    RowBox[{"r_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"q", "*", 
    RowBox[{
     RowBox[{"bmod", "[", 
      RowBox[{"r", ",", "z"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"me", "*", "c"}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.893182126038726*^9, 3.893182179940776*^9}, {
   3.893183810565749*^9, 3.893183823554469*^9}, 3.893227466783585*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"abcc299e-88e2-4790-84e2-c63f95692601"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]", "=", "1036.81"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}], ";"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.893182232890126*^9, 3.893182233312416*^9}, {
   3.8931838397425947`*^9, 3.893183839825699*^9}, {3.89323362939253*^9, 
   3.893233636206332*^9}, {3.893233980368581*^9, 3.8932339805003*^9}, {
   3.893234937976183*^9, 3.893234938304092*^9}, {3.893236798072822*^9, 
   3.893236802209523*^9}, {3.893246228732781*^9, 3.893246228793393*^9}, 
   3.893765891745179*^9, {3.893768740466086*^9, 3.89376874055348*^9}, {
   3.894117573063693*^9, 3.8941175803589497`*^9}, {3.894120645508788*^9, 
   3.894120650710326*^9}},ExpressionUUID->"80eb6fd4-15fc-4bf6-b620-\
c823e9020c3d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]r", "[", 
    RowBox[{"r_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"0.5", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[CapitalOmega]ce", "[", 
       RowBox[{"r", ",", "z"}], "]"}], "+", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalOmega]ce", "[", 
          RowBox[{"r", ",", "z"}], "]"}], "^", "2"}], "+", 
        RowBox[{"4", "*", 
         RowBox[{
          RowBox[{"\[Omega]pe", "[", 
           RowBox[{"r", ",", "z"}], "]"}], "^", "2"}]}]}], "]"}]}], ")"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]l", "[", 
    RowBox[{"r_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"0.5", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"\[CapitalOmega]ce", "[", 
        RowBox[{"r", ",", "z"}], "]"}]}], "+", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalOmega]ce", "[", 
          RowBox[{"r", ",", "z"}], "]"}], "^", "2"}], "+", 
        RowBox[{"4", "*", 
         RowBox[{
          RowBox[{"\[Omega]pe", "[", 
           RowBox[{"r", ",", "z"}], "]"}], "^", "2"}]}]}], "]"}]}], ")"}]}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.893182982253983*^9, 3.8931830717688427`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"5167b78c-1b50-45e4-b127-acf2b7ecdaad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]h", "[", 
    RowBox[{"r_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalOmega]ce", "[", 
       RowBox[{"r", ",", "z"}], "]"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"\[Omega]pe", "[", 
       RowBox[{"r", ",", "z"}], "]"}], "^", "2"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.89322804504316*^9, 3.893228107139042*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"ca9aeffd-8fd6-4bcc-a73e-f39de9dd1b4c"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Omega]pe", "[", 
      RowBox[{"x", ",", "0.0"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]r", "[", 
      RowBox[{"x", ",", "0.0"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]l", "[", 
      RowBox[{"x", ",", "0.0"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]h", "[", 
      RowBox[{"x", ",", "0.0"}], "]"}], ",", "\[IndentingNewLine]", 
     "\[Omega]"}], "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"Min", "[", "xGrid", "]"}], ",", 
     RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
   RowBox[{"PlotStyle", "->", 
    RowBox[{"{", 
     RowBox[{"Black", ",", "Blue", ",", "Red", ",", "Orange", ",", 
      RowBox[{"Directive", "[", 
       RowBox[{"Dashed", ",", "Black"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"ImageSize", "->", "Full"}], ",", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(pe\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(r\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(l\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(h\)]\)\>\"", ",", "\[Omega]"}], 
     "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.893234148185329*^9, 3.893234224496338*^9}, {
   3.893234282291595*^9, 3.893234287937148*^9}, {3.8932343250156393`*^9, 
   3.893234466127742*^9}, {3.893234585502902*^9, 3.893234595461299*^9}, 
   3.89323478890062*^9, {3.893234897546397*^9, 3.8932349067142143`*^9}, {
   3.893236813249378*^9, 3.893236822407452*^9}, {3.893238634892865*^9, 
   3.893238662662027*^9}, {3.893239129023521*^9, 3.893239132319209*^9}, {
   3.894117133926873*^9, 3.8941171812976427`*^9}, {3.8941177140040493`*^9, 
   3.894117758775496*^9}, {3.894117798202272*^9, 3.8941178026129913`*^9}, {
   3.8941179140826902`*^9, 3.894117921858927*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"7e7515d6-7205-44ce-b5b3-0e182605a323"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"fne", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Min", "[", "xGrid", "]"}], ",", 
       RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"Min", "[", "yGrid", "]"}], ",", 
       RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}], ",", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
     RowBox[{"ImageSize", "->", "Full"}], ",", 
     RowBox[{"PlotLegends", "->", "Automatic"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"f2", "[", 
        RowBox[{"rleft", ",", "zmin"}], "]"}], "[", 
       RowBox[{"x", ",", "y"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Min", "[", "xGrid", "]"}], ",", 
       RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"Min", "[", "yGrid", "]"}], ",", 
       RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}], ",", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
     RowBox[{"ContourShading", "->", "None"}], ",", " ", 
     RowBox[{"Contours", "->", "100"}], ",", 
     RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
     RowBox[{"PlotPoints", "->", "200"}], ",", 
     RowBox[{"ImageSize", "->", "Full"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"f2", "[", 
        RowBox[{"rleft", ",", "zmin"}], "]"}], "[", 
       RowBox[{"x", ",", "y"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Min", "[", "xGrid", "]"}], ",", 
       RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"Min", "[", "yGrid", "]"}], ",", 
       RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}], ",", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
     RowBox[{"ContourShading", "->", "None"}], ",", " ", 
     RowBox[{"Contours", "->", 
      RowBox[{"{", "psibry", "}"}]}], ",", 
     RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
     RowBox[{"PlotPoints", "->", "200"}], ",", 
     RowBox[{"ContourStyle", "->", "White"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "6"}], "]"}], "]"}], ",", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "8"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "15"}], "]"}], "]"}], ",", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "17"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "24"}], "]"}], "]"}], ",", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "26"}], "]"}], "]"}]}], "}"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"PlotStyle", "->", "Red"}]}], "]"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"\[Omega]pe", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Min", "[", "xGrid", "]"}], ",", 
       RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"Min", "[", "yGrid", "]"}], ",", 
       RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}], ",", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
     RowBox[{"ContourShading", "->", "None"}], ",", " ", 
     RowBox[{"Contours", "->", 
      RowBox[{"{", "\[Omega]", "}"}]}], ",", 
     RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
     RowBox[{"ContourStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{"Thick", ",", " ", "Black", ",", " ", "Dashed"}], "]"}]}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"\[Omega]r", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Min", "[", "xGrid", "]"}], ",", 
       RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"Min", "[", "yGrid", "]"}], ",", 
       RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}], ",", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
     RowBox[{"ContourShading", "->", "None"}], ",", " ", 
     RowBox[{"Contours", "->", 
      RowBox[{"{", "\[Omega]", "}"}]}], ",", 
     RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
     RowBox[{"ContourStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{"Thick", ",", " ", "Blue", ",", " ", "Dashed"}], "]"}]}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"\[Omega]l", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Min", "[", "xGrid", "]"}], ",", 
       RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"Min", "[", "yGrid", "]"}], ",", 
       RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}], ",", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
     RowBox[{"ContourShading", "->", "None"}], ",", " ", 
     RowBox[{"Contours", "->", 
      RowBox[{"{", "\[Omega]", "}"}]}], ",", 
     RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
     RowBox[{"ContourStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{"Thick", ",", " ", "White", ",", " ", "Dashed"}], "]"}]}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"\[Omega]h", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Min", "[", "xGrid", "]"}], ",", 
       RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"Min", "[", "yGrid", "]"}], ",", 
       RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}], ",", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
     RowBox[{"ContourShading", "->", "None"}], ",", " ", 
     RowBox[{"Contours", "->", 
      RowBox[{"{", "\[Omega]", "}"}]}], ",", 
     RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
     RowBox[{"ContourStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{"Thick", ",", " ", "Green", ",", " ", "Dashed"}], "]"}]}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"VectorPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"bvec", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3", ";;", "2"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Min", "[", "xGrid", "]"}], ",", 
       RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"Min", "[", "yGrid", "]"}], ",", 
       RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}], ",", 
     RowBox[{"VectorPoints", "->", "100"}], ",", 
     RowBox[{"VectorColorFunction", "->", "None"}], ",", 
     RowBox[{"VectorStyle", "->", "White"}]}], "]"}]}], "\[IndentingNewLine]",
   "]"}]], "Input",
 CellChangeTimes->{{3.892713751617206*^9, 3.892713789801162*^9}, {
   3.8927138552531633`*^9, 3.89271387990513*^9}, {3.8927139104563913`*^9, 
   3.8927139667317266`*^9}, {3.89271411620286*^9, 3.892714122182343*^9}, {
   3.892715276721077*^9, 3.892715281705882*^9}, {3.892716800779559*^9, 
   3.892716803467923*^9}, {3.8927170291137743`*^9, 3.892717035064876*^9}, {
   3.893175661519936*^9, 3.893175666881833*^9}, {3.8931764443166924`*^9, 
   3.893176478325348*^9}, {3.893176516170841*^9, 3.8931765166078653`*^9}, {
   3.8931767025287943`*^9, 3.893176745636592*^9}, {3.8931774906530533`*^9, 
   3.893177491136393*^9}, {3.89317765161162*^9, 3.893177679204163*^9}, {
   3.893180258321927*^9, 3.893180268442589*^9}, {3.893183090231166*^9, 
   3.893183109225787*^9}, {3.8931888714268312`*^9, 3.893188887392879*^9}, {
   3.893228082448542*^9, 3.8932280993992453`*^9}, {3.893233415491365*^9, 
   3.893233428558819*^9}, {3.893233596029117*^9, 3.8932335965236473`*^9}, {
   3.8932367720944843`*^9, 3.8932367739844103`*^9}, {3.893237565680233*^9, 
   3.8932375664616747`*^9}, {3.893245638004921*^9, 3.893245709582697*^9}, {
   3.893246261466721*^9, 3.893246269236171*^9}, {3.893246939552885*^9, 
   3.893246954442931*^9}, {3.893248924121611*^9, 3.893248937155196*^9}, 
   3.893249271255796*^9, {3.893249478192309*^9, 3.893249487687957*^9}, {
   3.89324968444903*^9, 3.893249685143964*^9}, {3.893765967658866*^9, 
   3.893765980754751*^9}, {3.8937666894286423`*^9, 3.893766693482172*^9}, {
   3.89376894205998*^9, 3.893768944245154*^9}, {3.893770015705508*^9, 
   3.893770056155354*^9}, {3.8937706418562593`*^9, 3.893770656360531*^9}},
 CellLabel->
  "In[331]:=",ExpressionUUID->"50a04208-b205-4322-844b-f7cf740b10e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kvec", "=", 
   RowBox[{"{", 
    RowBox[{"0.0", ",", "0.0", ",", "0.0"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8932555386988583`*^9, 3.89325554736302*^9}},
 CellLabel->
  "In[332]:=",ExpressionUUID->"d72c9664-5557-4cd8-8249-d0b39c3066b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"kvec", "/", "\[Omega]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8932555711961*^9, 3.893255582846705*^9}},
 CellLabel->
  "In[333]:=",ExpressionUUID->"dafd1781-8668-47e4-885f-544161f82fc7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nperp", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Cross", "[", 
    RowBox[{
     RowBox[{"bhat", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", "n"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.893255607145728*^9, 3.89325563742735*^9}},
 CellLabel->
  "In[334]:=",ExpressionUUID->"0632aafe-de75-49c0-bff2-62de0db575da"],

Cell[BoxData[
 RowBox[{"nperp", "[", 
  RowBox[{"2.5", ",", "0.0"}], "]"}]], "Input",
 CellLabel->
  "In[335]:=",ExpressionUUID->"b082b8c3-faf6-417d-a0ad-33c94072e4b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dispersion", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"1", "-", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Omega]pe", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], "/", 
     RowBox[{"\[Omega]", "^", "2"}]}], "-", 
    RowBox[{
     RowBox[{"nperp", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "*", 
     RowBox[{"nperp", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.893256024563734*^9, 3.893256049289474*^9}},
 CellLabel->
  "In[336]:=",ExpressionUUID->"52c3296d-8351-4311-b9e4-afb209f5761c"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"dispersion", "[", 
     RowBox[{"x", ",", "0.0"}], "]"}], "^", "2"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"Min", "[", "xGrid", "]"}], ",", 
     RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8932557377573633`*^9, 3.8932557490964613`*^9}, {
  3.893255824849298*^9, 3.893255841313653*^9}, {3.893256053905068*^9, 
  3.8932560574394407`*^9}, {3.893769294664648*^9, 3.893769295066402*^9}},
 CellLabel->
  "In[337]:=",ExpressionUUID->"5f03e2d5-60bc-4f55-ac7f-452ddb1aa414"],

Cell[BoxData[
 RowBox[{"ContourPlot", "[", 
  RowBox[{
   RowBox[{"dispersion", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"Min", "[", "xGrid", "]"}], ",", 
     RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"Min", "[", "yGrid", "]"}], ",", 
     RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
   RowBox[{"ContourShading", "->", "None"}], ",", " ", 
   RowBox[{"Contours", "->", 
    RowBox[{"{", "0", "}"}]}], ",", 
   RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
   RowBox[{"ContourStyle", "->", 
    RowBox[{"Directive", "[", 
     RowBox[{"Thick", ",", " ", "Black", ",", " ", "Dashed"}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8932551700806723`*^9, 3.893255176418488*^9}, {
   3.8932552926596937`*^9, 3.893255298703129*^9}, {3.89325534125611*^9, 
   3.893255372374011*^9}, {3.893255461784191*^9, 3.893255467130006*^9}, {
   3.893255666623774*^9, 3.893255696010454*^9}, 3.893255876434003*^9, {
   3.893769316860312*^9, 3.8937693212305317`*^9}, {3.8937693736069183`*^9, 
   3.893769376171227*^9}, {3.8937694079084997`*^9, 3.893769437098563*^9}, {
   3.893769495408437*^9, 3.8937694979993277`*^9}},
 CellLabel->
  "In[338]:=",ExpressionUUID->"982acba2-4a9f-4446-9a25-4e025e245626"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Floor", "[", 
      RowBox[{"p", "/", "psibry"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", 
       RowBox[{"Min", "[", "psi", "]"}], ",", 
       RowBox[{"2", "*", "psibry"}]}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"psibry", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"psibry", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.89585274274842*^9, 3.895852919311696*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"2b4dd79e-33de-481a-bc95-5fbde5d99525"],

Cell[BoxData[
 RowBox[{"DensityPlot", "[", 
  RowBox[{
   RowBox[{"Floor", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"f2", "[", 
        RowBox[{"rleft", ",", "zmin"}], "]"}], "[", 
       RowBox[{"x", ",", "y"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/", "psibry"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"Min", "[", "xGrid", "]"}], ",", 
     RowBox[{"Max", "[", "xGrid", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"Min", "[", "yGrid", "]"}], ",", 
     RowBox[{"Max", "[", "yGrid", "]"}]}], "}"}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
   RowBox[{"PlotPoints", "->", "200"}], ",", 
   RowBox[{"PlotLegends", "->", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.895852979241988*^9, 3.895853073235525*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"442da941-970d-4a9d-a406-048c45e40989"],

Cell[BoxData[
 RowBox[{"Min", "[", "psi", "]"}]], "Input",
 CellChangeTimes->{{3.8958541298131123`*^9, 3.8958541474538507`*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"067c52b9-ba7c-487b-941e-dbf65b6e1166"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1728, 1051},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"045994cb-b3e5-443f-9d78-3a67bf1e93e0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 200, 4, 96, "Title",ExpressionUUID->"5eddabab-0458-41c4-86d6-a3215d62b023"],
Cell[625, 21, 216, 5, 33, "Text",ExpressionUUID->"2c4c322c-5c01-4143-ad84-bfdf36b629e0"],
Cell[CellGroupData[{
Cell[866, 30, 151, 3, 66, "Section",ExpressionUUID->"c5ba8346-8b2a-4360-b5bb-ffb2c5d84a49"],
Cell[1020, 35, 256, 4, 29, "Input",ExpressionUUID->"a3271e63-15a0-44e8-8f73-02046ec37aae"],
Cell[1279, 41, 3766, 108, 274, "Input",ExpressionUUID->"de31985c-11ba-4789-9b9d-aaebe9694569"],
Cell[5048, 151, 584, 16, 49, "Input",ExpressionUUID->"1bf110d9-e785-4c6a-b732-832eca4086f2"],
Cell[5635, 169, 500, 13, 70, "Input",ExpressionUUID->"3a57c42a-9008-4fe3-8a01-8c9844291290"],
Cell[6138, 184, 210, 3, 29, "Input",ExpressionUUID->"d2f3f0f3-136e-4aec-a3f7-c612e8bfdc1b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6385, 192, 159, 3, 66, "Section",ExpressionUUID->"07f0000e-fbc0-4705-ba75-d481a5fc7e9f"],
Cell[6547, 197, 899, 27, 29, "Input",ExpressionUUID->"0498a238-2230-4072-9a52-ed7347f711ef"],
Cell[7449, 226, 784, 24, 29, "Input",ExpressionUUID->"59a40430-05e5-4502-ae3a-96e42b9ab617"],
Cell[8236, 252, 409, 11, 29, "Input",ExpressionUUID->"fd9b5d1a-7d75-41a4-b20a-947f2ddd44c5"],
Cell[8648, 265, 3639, 93, 294, "Input",ExpressionUUID->"126e3279-7860-4eb4-9416-3620a44b9b1e"],
Cell[12290, 360, 2652, 65, 151, "Input",ExpressionUUID->"29369115-0f38-4bdc-9833-becb55d928e8"],
Cell[14945, 427, 2808, 66, 151, "Input",ExpressionUUID->"fe8cd419-2e52-4aa5-b4cd-40cf52143072"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17790, 498, 152, 3, 66, "Section",ExpressionUUID->"a55628ec-9aad-4115-b5ce-b0860c7bd02e"],
Cell[17945, 503, 894, 18, 49, "Input",ExpressionUUID->"544e5f48-c95e-4e0d-9368-29cc3c61c75c"],
Cell[18842, 523, 574, 16, 49, "Input",ExpressionUUID->"1a732b3d-6ac1-4c76-9406-a21d89b62dd7"],
Cell[19419, 541, 365, 7, 29, "Input",ExpressionUUID->"f72fdd49-95f3-431b-988c-d7d8e4439193"],
Cell[19787, 550, 329, 8, 29, "Input",ExpressionUUID->"99d95e68-2702-4f42-835f-72613f2e7903"],
Cell[20119, 560, 2472, 60, 151, "Input",ExpressionUUID->"4e948bf4-a954-4490-84f4-56f702ff1941"],
Cell[22594, 622, 216, 4, 29, "Input",ExpressionUUID->"fe1e6fb9-8961-4106-aa4c-f9fb4e5f6023"],
Cell[22813, 628, 1292, 30, 29, "Input",ExpressionUUID->"964788eb-ca07-4efa-8f17-bcf5325838bd"],
Cell[24108, 660, 1715, 38, 29, "Input",ExpressionUUID->"b6fb8293-e767-47bc-a208-83ba3c6f43fe"],
Cell[25826, 700, 4447, 112, 213, "Input",ExpressionUUID->"de101dd5-20e7-4452-b98a-b5ca9c473502"],
Cell[30276, 814, 221, 4, 29, "Input",ExpressionUUID->"2edc4726-58c3-42b6-9408-bf1938741c2b"],
Cell[30500, 820, 1094, 26, 29, "Input",ExpressionUUID->"75f340da-b8d4-4be0-a80b-780f5b98f0dd"],
Cell[31597, 848, 1209, 31, 29, "Input",ExpressionUUID->"36737fa4-08f7-4315-9138-559288bac633"],
Cell[32809, 881, 4214, 109, 213, "Input",ExpressionUUID->"50c39e01-1a79-477d-b071-dbad65cf1765"],
Cell[37026, 992, 195, 4, 29, "Input",ExpressionUUID->"89b820f0-c4dd-4691-a98e-25693005a373"],
Cell[37224, 998, 986, 25, 29, "Input",ExpressionUUID->"12a2aaac-42e4-4214-9624-b719748c9961"],
Cell[38213, 1025, 1090, 29, 29, "Input",ExpressionUUID->"3f4450b7-d1f0-4f7b-8e23-6b8d99b4d474"],
Cell[39306, 1056, 1346, 37, 90, "Input",ExpressionUUID->"66eb1b9d-1a7e-4a03-b2b0-59e0f57471f8"],
Cell[40655, 1095, 196, 4, 29, "Input",ExpressionUUID->"d687f703-feac-4cc8-ac28-891f22fac149"],
Cell[40854, 1101, 993, 25, 29, "Input",ExpressionUUID->"c86dae18-d674-42c5-82a6-6774de23aae8"],
Cell[41850, 1128, 1090, 29, 29, "Input",ExpressionUUID->"f189a062-44b1-4078-a65e-e6304657ae0e"],
Cell[42943, 1159, 1347, 37, 90, "Input",ExpressionUUID->"8288630e-698e-46e1-84ab-b204bc98b39c"],
Cell[44293, 1198, 219, 4, 29, "Input",ExpressionUUID->"1182f37e-1b9c-42e6-8341-ebae544be9c0"],
Cell[44515, 1204, 1016, 25, 29, "Input",ExpressionUUID->"b77839a1-27ce-417b-95a5-2f6c9061760a"],
Cell[45534, 1231, 3382, 95, 131, "Input",ExpressionUUID->"ca2ea03b-a84f-4c06-a12b-cdafe9092b55"],
Cell[48919, 1328, 930, 24, 131, "Input",ExpressionUUID->"8099d70c-0231-4401-b184-21309806bec8"],
Cell[49852, 1354, 940, 22, 131, "Input",ExpressionUUID->"b28c0edf-59dc-4ee4-8393-f8955fde1691"],
Cell[50795, 1378, 587, 15, 29, "Input",ExpressionUUID->"ccb9d60c-8eb1-4e58-acf5-3fdd7312ddc8"],
Cell[51385, 1395, 281, 6, 29, "Input",ExpressionUUID->"7d804952-202a-4ef2-8e1e-66c8670c8646"],
Cell[51669, 1403, 790, 21, 29, "Input",ExpressionUUID->"f86be90d-d06a-4d5d-a15b-e12c0137171e"],
Cell[52462, 1426, 883, 27, 49, "Input",ExpressionUUID->"78fcc981-37c2-402f-adbf-182b55edf9cb"],
Cell[53348, 1455, 224, 4, 29, "Input",ExpressionUUID->"b8455c83-7ca2-42f3-9bca-80bbaa00d3a7"],
Cell[53575, 1461, 769, 19, 131, "Input",ExpressionUUID->"4db62d0b-2b7c-4c1b-b3f0-516283da13f8"],
Cell[54347, 1482, 18650, 554, 376, "Input",ExpressionUUID->"1eaf8389-5968-4c64-9af7-df1ab9f0d4e1"],
Cell[73000, 2038, 213, 4, 29, "Input",ExpressionUUID->"8d8b24d0-fc41-48ad-b5e1-94256e56dc94"],
Cell[73216, 2044, 1431, 41, 131, "Input",ExpressionUUID->"ce0c2139-8813-4958-b5b0-63b3431a8ef4"],
Cell[74650, 2087, 1165, 31, 131, "Input",ExpressionUUID->"dbbca63c-ba49-4c12-b890-ab5d8db44bf9"],
Cell[75818, 2120, 3856, 103, 233, "Input",ExpressionUUID->"849e0dc5-5a6a-4d89-942e-41c56b73979c"],
Cell[79677, 2225, 28178, 791, 376, "Input",ExpressionUUID->"3fcea19b-1a40-47bd-a8d7-290a77e19bcd"],
Cell[107858, 3018, 9375, 208, 376, "Input",ExpressionUUID->"dfa41d54-17bf-4038-b1ef-77a66d1666d8"],
Cell[117236, 3228, 5818, 151, 356, "Input",ExpressionUUID->"c4414f44-633e-4ff2-a6a8-2be0a11467f9"],
Cell[123057, 3381, 5860, 153, 376, "Input",ExpressionUUID->"cc52bca1-0f40-4876-8d48-0c96e0e0ec95"],
Cell[128920, 3536, 744, 21, 90, "Input",ExpressionUUID->"af510849-8698-4515-8ced-48c9bc6556e5"],
Cell[129667, 3559, 336, 9, 29, "Input",ExpressionUUID->"bdb6d979-6f9f-44cf-83f8-50583e4c2259"],
Cell[130006, 3570, 1354, 36, 90, "Input",ExpressionUUID->"18c472b0-fe55-4561-9f86-fb214c0263d3"],
Cell[131363, 3608, 477, 12, 29, "Input",ExpressionUUID->"4cc7dd36-72d1-417b-b594-0c8677272741"],
Cell[131843, 3622, 265, 6, 29, "Input",ExpressionUUID->"bf0c73a5-d9c8-44a5-a48e-daf090d8fc34"],
Cell[132111, 3630, 314, 7, 49, "Input",ExpressionUUID->"a61d1889-d8fa-42cb-9056-f1ef3d8fc86f"],
Cell[132428, 3639, 1777, 43, 111, "Input",ExpressionUUID->"83d1ba0f-e208-4540-88ad-05d3611fdec2"],
Cell[134208, 3684, 647, 18, 29, "Input",ExpressionUUID->"84a59c81-ad8c-4bc2-926e-7e2ece7c99a7"],
Cell[134858, 3704, 1054, 27, 29, "Input",ExpressionUUID->"480d842f-96f0-4043-b5c7-5fb37dbd1335"],
Cell[135915, 3733, 1847, 38, 29, "Input",ExpressionUUID->"662a832f-7d6f-4445-a977-c3bb640ef588"],
Cell[137765, 3773, 986, 27, 90, "Input",ExpressionUUID->"a423f5b1-3b16-46d9-98f8-290b44204552"],
Cell[138754, 3802, 467, 12, 29, "Input",ExpressionUUID->"5f0d7cbf-90a2-4bb8-a509-f6dac008fa55"],
Cell[139224, 3816, 596, 15, 29, "Input",ExpressionUUID->"ab769e9f-51cf-47b0-b079-168e30e016d5"],
Cell[139823, 3833, 536, 12, 29, "Input",ExpressionUUID->"af973acb-c750-48fc-aa9e-69d2efc6fc78"],
Cell[140362, 3847, 314, 8, 29, "Input",ExpressionUUID->"1ca54424-e6db-439b-9a02-c1caac040785"],
Cell[140679, 3857, 461, 14, 29, "Input",ExpressionUUID->"4430efcf-62a3-49fd-a47f-13f1f9a5e767"],
Cell[141143, 3873, 721, 21, 29, "Input",ExpressionUUID->"93194afd-c4de-4dd3-a575-ad39677f9716"],
Cell[141867, 3896, 478, 13, 29, "Input",ExpressionUUID->"a5885a62-43a5-49d4-b64f-d82769bd41a3"],
Cell[142348, 3911, 665, 18, 70, "Input",ExpressionUUID->"2e9d45da-d368-4a09-b687-0a4868a2bed2"],
Cell[143016, 3931, 818, 22, 29, "Input",ExpressionUUID->"7fb8f17b-3837-4095-bf9b-2228fff9a78d"],
Cell[143837, 3955, 701, 20, 29, "Input",ExpressionUUID->"0f1701b6-d244-4027-b911-78ab07a198d2"],
Cell[144541, 3977, 567, 17, 29, "Input",ExpressionUUID->"256cb068-2afb-4894-b792-19cea82acbe1"],
Cell[145111, 3996, 361, 8, 29, "Input",ExpressionUUID->"d1af4aa1-1905-479a-b502-3f7211e17976"],
Cell[145475, 4006, 286, 7, 29, "Input",ExpressionUUID->"9d9804c0-2e4c-41bf-9130-316bc1371355"],
Cell[145764, 4015, 213, 4, 29, "Input",ExpressionUUID->"aa58b1d8-67f9-4221-a90e-bad687ba31df"],
Cell[145980, 4021, 213, 4, 29, "Input",ExpressionUUID->"d3ac8609-71af-4e7b-875a-e4f2ddb61132"],
Cell[146196, 4027, 622, 18, 49, "Input",ExpressionUUID->"4d71df79-739f-4678-814a-a6ca1409f7f8"],
Cell[146821, 4047, 625, 18, 29, "Input",ExpressionUUID->"a26c9bf6-5ebd-4676-9af0-8906cec52ead"],
Cell[147449, 4067, 286, 7, 29, "Input",ExpressionUUID->"5973f11d-6524-48d2-b45e-7e6df47960f8"],
Cell[147738, 4076, 382, 8, 29, "Input",ExpressionUUID->"147bc25a-1dbe-4640-8768-98bdabc15469"],
Cell[148123, 4086, 217, 4, 29, "Input",ExpressionUUID->"2c403dbb-4e8e-4165-8650-f90944ac47d6"],
Cell[148343, 4092, 210, 4, 29, "Input",ExpressionUUID->"a759e04b-b11d-4dbf-b87c-19997c71af4c"],
Cell[148556, 4098, 338, 8, 29, "Input",ExpressionUUID->"bf3775d0-fdd5-4785-94d9-5b87f89e347b"],
Cell[148897, 4108, 213, 4, 29, "Input",ExpressionUUID->"33f2027f-6234-4648-aa03-90dfd79803d3"],
Cell[149113, 4114, 404, 8, 29, "Input",ExpressionUUID->"781cd006-8552-43e3-ae8b-8a8fbdfb9e8e"],
Cell[149520, 4124, 445, 11, 29, "Input",ExpressionUUID->"2d455eb8-b1e1-4072-aac1-7a51b9496e1e"],
Cell[149968, 4137, 416, 11, 29, "Input",ExpressionUUID->"0613254b-03f4-4583-9ece-e4bbcac1c872"],
Cell[150387, 4150, 416, 11, 29, "Input",ExpressionUUID->"ae80f178-55c1-4104-942e-8add5e71752d"],
Cell[150806, 4163, 218, 4, 29, "Input",ExpressionUUID->"424a7048-3395-437a-86d9-0259728ed421"],
Cell[151027, 4169, 264, 6, 29, "Input",ExpressionUUID->"b13efb3f-043f-4966-be57-175ef149a31a"],
Cell[151294, 4177, 315, 7, 29, "Input",ExpressionUUID->"d8085591-af12-48f3-b638-1cc3ac933e60"],
Cell[151612, 4186, 262, 6, 29, "Input",ExpressionUUID->"ee5564de-739c-4f62-aaf8-7b6bef0f4acb"],
Cell[151877, 4194, 16363, 384, 1030, "Input",ExpressionUUID->"b0b7d2d3-1c0b-443e-a311-5b82c9836e99"]
}, Open  ]],
Cell[CellGroupData[{
Cell[168277, 4583, 155, 3, 66, "Section",ExpressionUUID->"29c9a5c5-96a3-44dd-8275-164bcd67bc39"],
Cell[168435, 4588, 265, 5, 29, "Input",ExpressionUUID->"502c5a16-5fff-4e72-9725-64b74dffe2a2"],
Cell[168703, 4595, 390, 10, 29, "Input",ExpressionUUID->"ed140988-d230-4888-8966-7eb3cd1e8c9f"],
Cell[169096, 4607, 979, 25, 29, "Input",ExpressionUUID->"165b940c-6e23-49b0-8bea-021792700c0b"],
Cell[170078, 4634, 711, 14, 111, "Input",ExpressionUUID->"d57853a8-a581-46a7-9900-d46ed47db381"],
Cell[170792, 4650, 723, 18, 29, "Input",ExpressionUUID->"3a608216-8b3c-4353-836c-bb9fcc820f15"],
Cell[171518, 4670, 2088, 46, 111, "Input",ExpressionUUID->"1c7c1ad1-5d1d-4a9c-893e-70f439c1e76f"],
Cell[173609, 4718, 569, 15, 29, "Input",ExpressionUUID->"8f68d4d0-7369-44f1-8064-cdb64504bac6"],
Cell[174181, 4735, 418, 12, 29, "Input",ExpressionUUID->"3ac34c4b-bf7c-486b-aa81-0efc45ed437d"],
Cell[174602, 4749, 525, 14, 29, "Input",ExpressionUUID->"abcc299e-88e2-4790-84e2-c63f95692601"],
Cell[175130, 4765, 816, 17, 29, "Input",ExpressionUUID->"80eb6fd4-15fc-4bf6-b620-c823e9020c3d"],
Cell[175949, 4784, 1374, 42, 49, "Input",ExpressionUUID->"5167b78c-1b50-45e4-b127-acf2b7ecdaad"],
Cell[177326, 4828, 536, 16, 29, "Input",ExpressionUUID->"ca9aeffd-8fd6-4bcc-a73e-f39de9dd1b4c"],
Cell[177865, 4846, 2098, 43, 152, "Input",ExpressionUUID->"7e7515d6-7205-44ce-b5b3-0e182605a323"],
Cell[179966, 4891, 10085, 242, 437, "Input",ExpressionUUID->"50a04208-b205-4322-844b-f7cf740b10e9"],
Cell[190054, 5135, 285, 7, 29, "Input",ExpressionUUID->"d72c9664-5557-4cd8-8249-d0b39c3066b9"],
Cell[190342, 5144, 248, 6, 29, "Input",ExpressionUUID->"dafd1781-8668-47e4-885f-544161f82fc7"],
Cell[190593, 5152, 395, 11, 29, "Input",ExpressionUUID->"0632aafe-de75-49c0-bff2-62de0db575da"],
Cell[190991, 5165, 168, 4, 29, "Input",ExpressionUUID->"b082b8c3-faf6-417d-a0ad-33c94072e4b2"],
Cell[191162, 5171, 618, 18, 29, "Input",ExpressionUUID->"52c3296d-8351-4311-b9e4-afb209f5761c"],
Cell[191783, 5191, 603, 14, 29, "Input",ExpressionUUID->"5f03e2d5-60bc-4f55-ac7f-452ddb1aa414"],
Cell[192389, 5207, 1433, 32, 49, "Input",ExpressionUUID->"982acba2-4a9f-4446-9a25-4e025e245626"],
Cell[193825, 5241, 772, 22, 90, "Input",ExpressionUUID->"2b4dd79e-33de-481a-bc95-5fbde5d99525"],
Cell[194600, 5265, 1026, 27, 29, "Input",ExpressionUUID->"442da941-970d-4a9d-a406-048c45e40989"],
Cell[195629, 5294, 211, 4, 29, "Input",ExpressionUUID->"067c52b9-ba7c-487b-941e-dbf65b6e1166"]
}, Open  ]]
}, Open  ]]
}
]
*)

